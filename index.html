<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <!-- Иконка вкладки -->
    <link rel="icon" href="images/Team_Spirit_new_em.svg" type="image/svg+xml">
    <title>Team Spirit | DANO Solution</title>
  
    <!-- Подключаем CSS стиля Toxic -->
    <link rel="stylesheet" href="style-spirit.css">
  
    <!-- Подключаем библиотеку для графиков -->
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>

    <!-- Библиотека физики для Angry Birds -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.19.0/matter.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <script src="js/scatter_data.js"></script>
    <!-- <script src="js/revenue_scatter_data.js"></script> -->

    <style>
/* ОБНОВЛЕННЫЙ СТИЛЬ ЛЕГЕНДЫ ДЛЯ 7 СЛАЙДА (ЛЕВЫЙ ГРАФИК) */
#chart-area-age .apexcharts-legend {
    background: rgba(0, 0, 0, 0.85) !important;
    border: 1px solid var(--accent) !important;
    box-shadow: 0 4px 15px rgba(0,0,0,0.5) !important;
    padding: 15px !important;
    border-radius: 8px !important;
    
    /* ИЗМЕНЕНИЯ ЗДЕСЬ: */
    position: absolute !important;
    top: auto !important;
    bottom: 90px !important; /* <-- Увеличили с 30px до 90px, чтобы поднять выше */
    right: 30px !important;
    left: auto !important;
    
    display: flex !important;
    flex-direction: column !important;
    align-items: flex-start !important;
    width: max-content !important;
    max-height: 200px !important;
}

#chart-area-age .apexcharts-legend-series {
    margin-bottom: 8px !important;
    display: flex !important;
    align-items: center !important;
}

#chart-area-age .apexcharts-legend-series:last-child {
    margin-bottom: 0 !important;
}

#chart-area-age .apexcharts-legend-marker {
    margin-right: 10px !important;
}
    </style>

    <style>
        /* Custom Legend Style for Scatter Plot */
        #chart-heatmap .apexcharts-legend {
            background: rgba(0, 0, 0, 0.8) !important;
            border: 1px solid var(--accent) !important;
            padding: 10px !important;
            border-radius: 8px !important;
            /* Ensure it floats correctly */
            right: 20px !important;
            left: auto !important;
            width: auto !important;
            bottom: 60px !important;
            top: auto !important;
            display: flex !important;
            flex-direction: column !important;
            align-items: flex-start !important;
            text-align: left !important;
        }
        #chart-heatmap .apexcharts-legend-marker {
            margin-right: 10px !important;
        }

        /* Custom Legend Style for Revenue Chart (Left) */
        #chart-revenue .apexcharts-legend {
            background: rgba(0, 0, 0, 0.8) !important;
            border: 1px solid var(--accent) !important;
            padding: 10px !important;
            border-radius: 8px !important;
            
            /* Force position and size */
            position: absolute !important;
            top: 30px !important;
            right: 30px !important;
            left: auto !important;
            width: max-content !important;
            
            display: flex !important;
            flex-direction: column !important;
            align-items: flex-start !important;
        }
        #chart-revenue .apexcharts-legend-marker {
            margin-right: 10px !important;
        }
    </style>
</head>
<body>

    <!-- ВОДЯНОЙ ЗНАК -->
    <div class="watermark-container">
        <div class="watermark-text">TEAM SPIRIT</div>
        <img src="images/Team_Spirit_new_em.svg" alt="TS Logo" class="logo-watermark-img" style="filter: brightness(0) invert(1);">
    </div>

    <!-- СЧЕТЧИК СЛАЙДОВ -->
    <div class="slide-counter">
        <span id="currSlide" style="color: var(--accent);">01</span> / <span id="totalSlide">25</span>
    </div>

    <!-- ================= СЛАЙДЫ ================= -->

    <!-- 01. ТИТУЛЬНИК -->
    <div class="slide active flex-center">
        <div>
            <div style="display: flex; justify-content: center; align-items: center; gap: 30px; margin-bottom: 40px;">
                <img src="images/Team_Spirit_new_em.svg" alt="TS Logo" style="filter: brightness(0) invert(1); width: 180px; drop-shadow: 0 0 15px rgba(198, 255, 0, 0.2);">
                <span style="font-size: 3rem; font-weight: 900; color: var(--accent); text-shadow: 0 0 10px var(--accent);">X</span>
                <img src="images/X5_Tech.svg" alt="X5 Tech Logo" style="filter: brightness(0) invert(1); width: 300px; drop-shadow: 0 0 15px rgba(198, 255, 0, 0.2);">
            </div>
          
            <p style="letter-spacing: 4px; color: var(--accent); margin-bottom: 15px; font-weight: 700; text-shadow: 0 0 10px rgba(198, 255, 0, 0.4); font-size: 1.4rem;">DANO OLYMPIAD 2025</p>
            <h1>Любовь одна а Data 2</h1>
            <div style="width: 80px; height: 6px; background: var(--accent); margin: 25px auto; box-shadow: 0 0 10px var(--accent);"></div>
            <p>Команда: Тим Спирит (филиал Таганрог)</p>
            <br>
            <div style="display: flex; justify-content: center; gap: 10px; flex-wrap: wrap;">
                <span class="tag">#DOTA_SCIENCE</span>
                <span class="tag">#ANALYTICS</span>
                <span class="tag">#TEAM_SPIRIT</span>
            </div>
        </div>
    </div>

   <!-- 02. СТРУКТУРА ДАТАСЕТА -->
    <div class="slide">
        <h2>Структура данных</h2>
        <!-- 1. Задали фиксированную высоту сетке (70vh) и убрали align-items: start -->
        <div style="display: grid; grid-template-columns: 1.2fr 0.8fr; gap: 30px; height: 70vh;">
          
            <!-- ЛЕВАЯ КОЛОНКА -->
            <div style="display: flex; flex-direction: column; gap: 20px; height: 100%;">
              
                <!-- Верхняя карточка -->
                <div class="card" style="display: flex; flex-direction: row; justify-content: space-between; align-items: center; border: 2px solid var(--accent); background: rgba(198, 255, 0, 0.05); padding: 20px;">
                    <div>
                        <h3 style="margin: 0; font-size: 1.6rem;">Данные о магазинах</h3>
                        <p style="margin: 5px 0 0 0; font-size: 1.4rem; opacity: 0.8;">Торговой сети "Пятерочка"</p>
                    </div>
                </div>

                <!-- Средние карточки (статистика) -->
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="card">
                        <div class="big-stat">256k</div>
                        <div class="stat-label">Строк данных</div>
                    </div>
                    <div class="card">
                        <div class="big-stat">21k</div>
                        <div class="stat-label">Магазинов</div>
                    </div>
                </div>

                <!-- Нижняя карточка (Период) -> добавили flex: 1, чтобы она растянулась до низа -->
                <div class="card" style="text-align: center; flex: 1; display: flex; flex-direction: column; justify-content: center;">
                    <h3>Период данных</h3>
                    <div class="big-stat" style="font-size: 4.5rem; margin: 10px 0;">2024</div>
                    <p>Информация по каждому месяцу</p>
                </div>
            </div>

            <!-- ПРАВАЯ КОЛОНКА -->
            <div style="display: flex; flex-direction: column; gap: 20px; height: 100%;">
                <!-- Добавили flex: 1 обеим карточкам, чтобы они равномерно заполнили высоту -->
                <div class="card" style="flex: 1; display: flex; flex-direction: column; justify-content: center;">
                    <h3>Числовые признаки</h3>
                    <ul style="list-style: none; padding: 0; margin-top: 15px; font-size: 1.4rem;">
                        <li style="margin-bottom: 12px;">• Средний чек</li>
                        <li style="margin-bottom: 12px;">• Трафик</li>
                        <li style="margin-bottom: 12px;">• Инфраструктура <span style="color: var(--accent);">*</span></li>
                        <li>• Население</li>
                    </ul>
                    <p style="margin-top: 15px; font-size: 1.3rem; color: #888;">
                        <span style="color: var(--accent);">*</span> много переменных об окружении и трафике
                    </p>
                </div>
              
                <div class="card" style="flex: 1; display: flex; flex-direction: column; justify-content: center;">
                    <h3>Категориальные признаки</h3>
                    <ul style="list-style: none; padding: 0; margin-top: 15px; font-size: 1.4rem;">
                        <li style="margin-bottom: 12px;">• Площадь</li>
                        <li style="margin-bottom: 12px;">• Дата открытия</li>
                        <li style="margin-bottom: 12px;">• Населенный пункт</li>
                        <li>• Месяц (порядковая)</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- 03. ФОКУСИРОВКА ВЫБОРКИ -->
    <div class="slide">
        <h2>ФОКУСИРОВКА ВЫБОРКИ</h2>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 40px; height: 70vh;">
            <div style="display: flex; flex-direction: column; justify-content: center;">              
                <div class="card" style="padding: 25px; margin-bottom: 20px; border-left: 4px solid var(--accent);">
                    <h3 style="color: var(--accent); margin-bottom: 10px; font-size: 1.8rem;">ПРОБЛЕМА МАЛЫХ ГОРОДОВ</h3>
                    <p style="font-size: 1.4rem;">Мало магазинов, следовательно, в них идут не по предпочтениям, а из-за отсутствия альтернатив.</p>
                </div>

                <div style="margin-left: 20px;">
                    <h3 style="margin-bottom: 15px; font-size: 1.6rem;">ПОЧЕМУ <span style="color: var(--accent);">МИЛЛИОННИКИ?</span></h3>
                    <ul style="list-style: none; padding: 0;">
                        <li style="margin-bottom: 15px; font-size: 1.6rem; display: flex; align-items: center;">
                            <span style="color: var(--accent); font-size: 1.8rem; margin-right: 15px;">✓</span> 
                            Структурная однородность среды
                        </li>
                        <li style="margin-bottom: 15px; font-size: 1.6rem; display: flex; align-items: center;">
                            <span style="color: var(--accent); font-size: 1.8rem; margin-right: 15px;">✓</span> 
                            Высокая плотность данных
                        </li>
                        <li style="margin-bottom: 15px; font-size: 1.6rem; display: flex; align-items: center;">
                            <span style="color: var(--accent); font-size: 1.8rem; margin-right: 15px;">✓</span> 
                            Высокая конкуренция между магазинами
                        </li>
                    </ul>
                </div>

                <div class="card" style="margin-top: 20px; padding: 15px; border-left: 4px solid var(--accent); background: rgba(198, 255, 0, 0.05);">
                    <p style="font-size: 1.4rem; margin: 0;">Из 256 тыс. строк осталось 62 тыс.</p>
                </div>
            </div>

            <div style="display: flex; flex-direction: column; gap: 20px;">
                <div class="card" style="flex: 1; padding: 10px; overflow: hidden;">
                    <div class="chart-container-fix">
                        <div id="chart-cities-pie" style="width: 100%; height: 100%;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 04. СТАТИСТИКА: СРЕДНИЙ ЧЕК И ТРАФИК (ОБНОВЛЕННЫЙ) -->
    <div class="slide" id="chartSlideMeanCheck">
        <h2>СТАТИСТИКА: СРЕДНИЙ ЧЕК И ТРАФИК</h2>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 40px; height: 70vh;">
            
            <!-- ЛЕВАЯ КОЛОНКА: СРЕДНИЙ ЧЕК -->
            <div class="card" style="padding: 30px; display: flex; flex-direction: column; border-left: 6px solid var(--accent); background: rgba(198, 255, 0, 0.05);">
                <div style="margin-bottom: 25px; border-bottom: 1px solid rgba(198, 255, 0, 0.3); padding-bottom: 15px;">
                    <h3 style="margin: 0; font-size: 2.2rem; color: #fff;">Средний чек</h3>
                    <span style="font-size: 1.2rem; color: #888;">рублей за визит</span>
                </div>

                <div style="display: flex; flex-direction: column; gap: 15px; font-size: 1.6rem;">
                    
                    <!-- MEAN -->
                    <div style="display: flex; justify-content: space-between; align-items: center; background: rgba(0,0,0,0.3); padding: 15px; border-radius: 8px;">
                        <span style="color: #aaa;">Среднее</span>
                        <span style="color: var(--accent); font-weight: 900; font-size: 2rem;">1 026 ₽</span>
                    </div>

                    <!-- MEDIAN -->
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px 15px; border-bottom: 1px solid #333;">
                        <span style="color: #aaa;">Медиана</span>
                        <span style="color: #fff; font-weight: bold;">953 ₽</span>
                    </div>

                    <!-- STD -->
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px 15px; border-bottom: 1px solid #333;">
                        <span style="color: #888;">Стандартное отклонение</span>
                        <span style="color: #ddd;">358 ₽</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px 15px; border-bottom: 1px solid #333;">
                        <span style="color: #888;">Минимум</span>
                        <span style="color: #ddd;">0 ₽</span>
                    </div>

                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px 15px; border-bottom: 1px solid #333;">
                        <span style="color: #888;">Максимум</span>
                        <span style="color: #ddd;">3600 ₽</span>
                    </div>


                    

                </div>
            </div>

            <!-- ПРАВАЯ КОЛОНКА: ТРАФИК -->
            <div class="card" style="padding: 30px; display: flex; flex-direction: column; border-left: 6px solid #fff;">
                <div style="margin-bottom: 25px; border-bottom: 1px solid rgba(255, 255, 255, 0.3); padding-bottom: 15px;">
                    <h3 style="margin: 0; font-size: 2.2rem; color: #fff;">Трафик</h3>
                    <span style="font-size: 1.2rem; color: #888;">человек в месяц</span>
                </div>

                <div style="display: flex; flex-direction: column; gap: 15px; font-size: 1.6rem;">
                    
                    <!-- MEAN -->
                    <div style="display: flex; justify-content: space-between; align-items: center; background: rgba(0,0,0,0.3); padding: 15px; border-radius: 8px;">
                        <span style="color: #aaa;">Среднее</span>
                        <span style="color: #fff; font-weight: 900; font-size: 2rem;">65 782</span>
                    </div>

                    <!-- MEDIAN -->
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px 15px; border-bottom: 1px solid #333;">
                        <span style="color: #aaa;">Медиана</span>
                        <span style="color: #fff; font-weight: bold;">63 483</span>
                    </div>

                    <!-- STD -->
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px 15px; border-bottom: 1px solid #333;">
                        <span style="color: #888;">Стандартное отклонение</span>
                        <span style="color: #ddd;">15 313</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px 15px; border-bottom: 1px solid #333;">
                        <span style="color: #888;">Минимум</span>
                        <span style="color: #ddd;">250</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px 15px; border-bottom: 1px solid #333;">
                        <span style="color: #888;">Максимум</span>
                        <span style="color: #ddd;">146 139</span>
                    </div>

                    <!-- MIN / MAX как таблица -->
                

                </div>
            </div>
        </div>
    </div>

    <!-- 05. SCATTER PLOT (ОБНОВЛЕННЫЙ СЛАЙД - КАРТИНКА) -->
    <div class="slide" id="chartSlideScatter">
        <h2>ВВОД ПЕРЕМЕННОЙ: ВЫРУЧКА</h2>
      
        <!-- 1. Задали общую высоту 70vh для выравнивания низа -->
        <div style="display: grid; grid-template-columns: 1fr 300px; gap: 30px; height: 70vh;">
          
            <!-- Левая часть: Картинка графика -->
            <!-- 2. Добавили height: 100%, чтобы карточка занимала всю высоту ячейки -->
            <div class="card" style="padding: 0px; overflow: hidden; display: flex; flex-direction: column; justify-content: center; align-items: center; background: #000; height: 100%;">
                <div class="chart-container-fix" style="width: 100%; height: 100%; display: flex; justify-content: center; align-items: center;">
                    <img src="images/image_2025-12-14_21-38-47.png" alt="График зависимости" style="max-width: 100%; max-height: 100%; object-fit: contain; border-radius: 4px;">
                </div>
            </div>

            <!-- Правая часть: Описание -->
            <!-- 3. Добавили height: 100%, чтобы контейнер колонки был во всю высоту -->
            <div style="display: flex; flex-direction: column; gap: 20px; height: 100%;">
              
                <!-- 4. Добавили flex: 1, чтобы эта карточка растянулась и заполнила пустоту -->
                <div class="card" style="border: 2px solid var(--accent); background: rgba(198, 255, 0, 0.05); flex: 1; display: flex; flex-direction: column; justify-content: center;">
                    <h3>ФОРМУЛА</h3>
                    <div style="font-size: 1.8rem; font-weight: 900; margin: 15px 0;">
                        ВЫРУЧКА = <br>
                        <span style="color: var(--accent);">ТРАФИК</span> × СРЕДНИЙ ЧЕК
                    </div>
                    <p style="font-size: 1.3rem; opacity: 0.7;">
                        Обе переменные модифицированы составителями датасета.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- 06. ВЛИЯНИЕ ПЯТЕРОЧЕК -->
    <div class="slide" id="chartSlide2">
        <h2>ВЛИЯНИЕ ПЯТЕРОЧЕК</h2>
        
        <div class="card" style="margin-bottom: 20px; padding: 15px; text-align: center;">
            <p style="font-size: 1.5rem; margin: 0; color: #ccc;">
                Единственное, что <span style="color: var(--accent); font-weight: bold;">X5</span> контролирует из инфраструктуры в датасете полностью и напрямую, - это количество пятёрочек в округе
            </p>
        </div>
        
        <!-- Сетка с фиксированной высотой 65vh -->
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; height: 65vh;">
            
            <!-- ЛЕВАЯ КОЛОНКА: Вектор корреляций (Таблица) -->
            <!-- Убрали лишние обертки, оставили одну карточку на всю высоту -->
            <div class="card" style="padding: 0; overflow: hidden; display: flex; flex-direction: column; height: 100%; width: 100%; border: 1px dashed #555;">
                
                <!-- Заголовок таблицы -->
                <div style="padding: 20px 25px; border-bottom: 1px solid #333; background: rgba(255,255,255,0.02); flex-shrink: 0;">
                    <h3 style="margin: 0; color: #fff; font-size: 1.6rem;">Корреляция с Выручкой</h3>
                    <div style="font-size: 1.2rem; color: #666; margin-top: 5px;">Факторы инфраструктуры</div>
                </div>

                <!-- Тело таблицы (растягивается на всю оставшуюся высоту) -->
                <div style="flex: 1; display: flex; flex-direction: column; width: 100%; justify-content: space-between;">
                    
                    <!-- ПОЗИТИВНЫЕ -->
                    <div style="flex: 1; display: flex; align-items: center; justify-content: space-between; padding: 0 25px; border-bottom: 1px solid #222;">
                        <span style="color: #ccc; font-size: 1.4rem;">E-commerce</span>
                        <span style="color: #ccc; font-weight: bold; font-size: 1.4rem;">0.23</span>
                    </div>

                    <!-- НЕЙТРАЛЬНЫЕ -->
                    <div style="flex: 1; display: flex; align-items: center; justify-content: space-between; padding: 0 25px; border-bottom: 1px solid #222;">
                        <span style="color: #999; font-size: 1.3rem;">Остановки</span>
                        <span style="color: #999; font-size: 1.3rem;">0.19</span>
                    </div>
                    <div style="flex: 1; display: flex; align-items: center; justify-content: space-between; padding: 0 25px; border-bottom: 1px solid #222;">
                        <span style="color: #888; font-size: 1.3rem;">Домохозяйства</span>
                        <span style="color: #888; font-size: 1.3rem;">0.17</span>
                    </div>
                    <div style="flex: 1; display: flex; align-items: center; justify-content: space-between; padding: 0 25px; border-bottom: 1px solid #222;">
                        <span style="color: #777; font-size: 1.3rem;">Медучреждения</span>
                        <span style="color: #777; font-size: 1.3rem;">0.15</span>
                    </div>
                    <div style="flex: 1; display: flex; align-items: center; justify-content: space-between; padding: 0 25px; border-bottom: 1px solid #222;">
                        <span style="color: #666; font-size: 1.3rem;">Школы</span>
                        <span style="color: #666; font-size: 1.3rem;">0.13</span>
                    </div>

                    <!-- ОТРИЦАТЕЛЬНЫЕ -->
                    <div style="flex: 1; display: flex; align-items: center; justify-content: space-between; padding: 0 25px; border-bottom: 1px solid #222; background: rgba(255, 85, 85, 0.05);">
                        <span style="color: #ffaaaa; font-size: 1.3rem;">Другие магазины</span>
                        <span style="color: #ff5555; font-weight: bold; font-size: 1.3rem;">-0.13</span>
                    </div>
                    
                    <!-- TARGET (Увеличенный вес) -->
                    <div style="flex: 1.4; display: flex; align-items: center; justify-content: space-between; padding: 0 25px; background: rgba(255, 85, 85, 0.15); border-left: 6px solid #ff5555;">
                        <span style="color: #fff; font-weight: bold; font-size: 1.5rem;">Пятерочки рядом</span>
                        <span style="color: #ff5555; font-weight: 900; font-size: 1.8rem;">-0.15</span>
                    </div>

                </div>
            </div>

            <!-- ПРАВАЯ КОЛОНКА: График (Картинка) -->
            <div id="chart-revenue-container" style="display: flex; justify-content: center; align-items: center; overflow: hidden; border: 1px dashed var(--accent); padding: 10px; border-radius: 8px; position: relative; height: 100%;">
                <img src="images/первый.png" alt="Revenue Chart" style="max-width: 100%; max-height: 100%; object-fit: contain;">
            </div>

        </div>
    </div>

    <!-- 07. СТРУКТУРА: ПЛОЩАДЬ И ВЫРУЧКА -->
    <div class="slide" id="chartSlideDist">
        <h2>СТРУКТУРА МАГАЗИНОВ И ВЫРУЧКА</h2>
      
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; height: 70vh;">
          
            <!-- ЛЕВЫЙ ГРАФИК: Количество (Распределение) -->
            <div class="card" style="padding: 15px; display: flex; flex-direction: column; overflow: hidden;">
                <h3 style="text-align: center; margin-bottom: 5px; font-size: 1.5rem; color: var(--accent);">1. Количество магазинов</h3>
                <div class="chart-container-fix" style="flex: 1;">
                    <div id="chart-area-age" style="width: 100%; height: 100%;"></div>
                </div>
            </div>

            <!-- ПРАВЫЙ ГРАФИК: Выручка (Boxplot) -->
            <div class="card" style="padding: 15px; display: flex; flex-direction: column; overflow: hidden;">
                <h3 style="text-align: center; margin-bottom: 5px; font-size: 1.5rem; color: var(--accent);">2. Выручка по возрасту (млн ₽)</h3>
                <div class="chart-container-fix" style="flex: 1;">
                    <div id="chart-area-rev-box" style="width: 100%; height: 100%;"></div>
                </div>
            </div>
          
        </div>
    </div>

    <!-- 08. ВВОД НОВОЙ БИНАРНОЙ ПЕРЕМЕННОЙ -->
    <div class="slide" id="slide-metrics">
        <h2>ВВОД НОВОЙ БИНАРНОЙ ПЕРЕМЕННОЙ</h2>
      
        <div style="display: grid; grid-template-columns: 1.5fr 1fr; gap: 30px; height: 70vh;">
          
            <!-- Left Column: 2 Charts -->
            <div style="display: flex; flex-direction: column; gap: 20px;">
                <div class="card" style="flex: 1; display: flex; flex-direction: column; overflow: hidden;">
                    <h4 style="margin-bottom: 5px; text-align: center;">Распределение по кол-ву пятерочек</h4>
                    <div class="chart-container-fix" style="flex: 1;">
                        <div id="chart-pyat-dist-new" style="width: 100%; height: 100%;"></div>
                    </div>
                </div>
                <!-- <div class="card" style="flex: 1; display: flex; flex-direction: column; overflow: hidden;">
                    <h4 style="margin-bottom: 5px; text-align: center;">Распределение по кол-ву магазинов</h4>
                    <div class="chart-container-fix" style="flex: 1;">
                        <div id="chart-shops-dist-new" style="width: 100%; height: 100%;"></div>
                    </div>
                </div> -->
            </div>

            <!-- Right Column: Explanation + Binary Stats -->
            <!-- Right Column: Explanation + Binary Stats -->
            <div style="display: flex; flex-direction: column; gap: 20px;">
                <!-- Новая переменная: наличие пятерочек (500 метров) -->
                <div class="card" style="padding: 20px; flex: 1; display: flex; flex-direction: column; justify-content: center;">
                    <h3 style="margin-bottom: 20px; text-align: center;">Новая переменная: наличие пятерочек (500 метров)</h3>
                  
                    <div style="display: flex; flex-direction: column; gap: 30px;">
                        <!-- 0: Без Пятерочек -->
                        <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 8px; border-left: 4px solid #888;">
                            <div style="font-size: 1.3rem; color: #aaa; margin-bottom: 5px;">Без пятерочек</div>
                            <div style="font-size: 2.2rem; font-weight: 900; color: #fff;">1 332</div>
                            <div style="font-size: 1.2rem; color: #666;">~26.5%</div>
                        </div>

                        <!-- 1: С Пятерочками -->
                        <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 8px; border-left: 4px solid var(--accent);">
                            <div style="font-size: 1.3rem; color: #aaa; margin-bottom: 5px;">С пятерочками</div>
                            <div style="font-size: 2.2rem; font-weight: 900; color: #fff;">3 699</div>
                            <div style="font-size: 1.2rem; color: #666;">~73.5%</div>
                        </div>
                    </div>
                </div>
                <!-- Почему бинарная? -->
                <div class="card" style="padding: 20px;">
                    <h3 style="color: var(--accent); margin-bottom: 10px;">Почему бинарная?</h3>
                    <p>
                        Оценивание эффекта наличия пятерочек обобщеннее эффекта количества.
                    </p>
                </div>
            </div>

        </div>
    </div>
  

    <!-- 09. ИССЛЕДОВАТЕЛЬСКИЙ ВОПРОС -->
    <div class="slide">
        <h2>ИССЛЕДОВАТЕЛЬСКИЙ ВОПРОС</h2>
        <div class="card flex-center" style="flex: 1;">
            <h1 style="font-size: 2.8rem; text-align: center;">
                Как соседство с <span style="color: #ea1f41;">пятерочками</span> влияет на <span style="color: var(--accent);">выручку</span>?
            </h1>
        </div>
    </div>

    <!-- 10. ОБРАБОТКА ДАННЫХ -->
    <div class="slide">
        <h2>ОБРАБОТКА ДАННЫХ</h2>
      
        <div style="display: grid; grid-template-columns: 2.5fr 1fr; gap: 30px; height: 70vh;">
          
            <!-- ЛЕВАЯ КОЛОНКА: Очистка -->
            <div class="card" style="padding: 30px; border-left: 6px solid #ff5555; background: rgba(12, 12, 12, 0.34); display: flex; flex-direction: column; justify-content: center;">
              
                <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 30px;">
                    <h3 style="color: #ff4a4a; margin: 0; font-size: 2rem;">ОЧИСТКА ДАННЫХ</h3>
                </div>
              
                <div style="display: flex; flex-direction: column; gap: 25px;">
                    <h3 style="margin-bottom: 15px; font-size: 1.5rem; color: #fff; font-weight: 400;">Удаляем кластер экстремально маленьких средних выручек и чеков</h3>
                    <div style="overflow: hidden; margin-bottom: 20px; border: 1px solid rgba(255, 85, 85, 0.182); border-radius: 10px; background: rgba(0, 0, 0, 0.2);">
                        <table style="width: 100%; border-collapse: collapse; font-size: 1.4rem;">
                            <thead>
                                <tr style="background: rgba(255, 85, 85, 0.1); border-bottom: 1px solid rgba(255, 85, 85, 0.4);">
                                    <th style="text-align: left; padding: 15px; color: #fff; border-right: 1px solid rgba(255, 85, 85, 0.2); font-weight: bold;">Критерий</th>
                                    <th style="text-align: left; padding: 15px; color: #fff; font-weight: bold;">Пороговое значение</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr style="border-bottom: 1px solid rgba(255, 85, 85, 0.011);">
                                    <td style="padding: 15px; color: #ccc; border-right: 1px solid rgba(255, 85, 85, 0.2);">Средний чек магазина за месяц</td>
                                    <td style="text-align: left; padding: 15px; font-weight: bold; color: #fff;">500 рублей</td>
                                </tr>
                                <tr>
                                    <td style="padding: 15px; color: #ccc; border-right: 1px solid rgba(255, 85, 85, 0.2);">Трафик за месяц</td>
                                     <td style="text-align: left; padding: 15px; font-weight: bold; color: #fff;">
                                        20тыс. человек<br>
                                        <span style="font-size: 1rem; color: #999; font-weight: normal;">(меньше 700 в день)</span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div style="background: rgba(0,0,0,0.3); padding: 20px; border-radius: 10px; border: 1px solid #444;">
                        <p style="font-size: 1.5rem; margin: 0;">
                            Удалено строк: <span style="color: var(--accent); font-weight: bold;">596</span> из 62 тысяч - <span style="color: var(--accent);">меньше 1%</span>
                        </p>
                    </div>

                    <!-- <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid rgba(255,255,255,0.1);">
                        <p style="font-size: 1.8rem; font-weight: 900; color: var(--accent); text-align: center; text-transform: uppercase; letter-spacing: 1px;">
                            Это показывает нам, что датасет - ошибка выжившего
                        </p>
                    </div> -->
                </div>
            </div>

            <!-- ПРАВАЯ КОЛОНКА: Пропуски и Удаленные по дате -->
            <div style="display: flex; flex-direction: column; gap: 20px;">
                <!-- Пропуски -->
                <div class="card" style="padding: 20px; flex: 0.6; display: flex; flex-direction: column; justify-content: center; border-left: 6px solid var(--accent); background: rgba(198, 255, 0, 0.05);">
                    <h3 style="color: var(--accent); margin-bottom: 5px; font-size: 1.4rem;">ПРОПУСКИ</h3>
                    <div style="text-align: center;">
                        <span style="font-size: 4rem; font-weight: 900; color: #fff; line-height: 1; text-shadow: 0 0 20px rgba(255,255,255,0.3);">0</span>
                        <div style="font-weight: 700; color: var(--accent); font-size: 1.2rem;">ПУСТЫХ ЗНАЧЕНИЙ</div>
                    </div>
                </div>

                <!-- Удалено по дате -->
                <div class="card" style="padding: 20px; flex: 1.4; border-left: 6px solid #ff5555; background: rgba(255, 85, 85, 0); display: flex; flex-direction: column; justify-content: center;">
                    <h3 style="color: #ff5555; margin-bottom: 15px; font-size: 1.3rem;">УДАЛЕННЫЕ СТРОКИ ПО ДАТЕ ОТКРЫТИЯ</h3>
                    <div style="display: flex; flex-direction: column; gap: 15px;">
                        <!-- Новый -->
                        <div style="background: rgba(0,0,0, 1); padding: 15px; border-radius: 8px; display: flex; justify-content: space-between; align-items: center;">
                            <div style="font-size: 1.2rem; color: #ccc;">Новый</div>
                            <div style="font-size: 1.8rem; font-weight: bold; color: #fff;">576</div>
                        </div>
                        <!-- Средний по возрасту -->
                        <div style="background: rgba(0,0,0, 1); padding: 15px; border-radius: 8px; display: flex; justify-content: space-between; align-items: center;">
                            <div style="font-size: 1.2rem; color: #ccc;">Средний по возрасту</div>
                            <div style="font-size: 1.8rem; font-weight: bold; color: #fff;">13</div>
                        </div>
                        <!-- Открыт давно -->
                        <div style="background: rgba(0,0,0, 1); padding: 15px; border-radius: 8px; display: flex; justify-content: space-between; align-items: center;">
                            <div style="font-size: 1.2rem; color: #ccc;">Открыт давно</div>
                            <div style="font-size: 1.8rem; font-weight: bold; color: #fff;">7</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 11. ВЫРУЧКА ПО ДАТАМ ОТКРЫТИЯ -->
    <div class="slide" id="chartSlideAge">
        <h2>СРЕДНЯЯ ВЫРУЧКА ПО ДАТАМ ОТКРЫТИЯ</h2>
      
        <div style="display: grid; grid-template-columns: 3fr 1fr; gap: 30px; height: 70vh;">
          
            <!-- ГРАФИК -->
            <div class="card" style="padding: 20px; display: flex; flex-direction: column; overflow: hidden;">
                <!-- chart-container-fix гарантирует, что график займет всю высоту и ширину -->
                <div class="chart-container-fix" style="flex: 1; min-height: 0;">
                    <div id="chart-age-revenue" style="width: 100%; height: 100%;"></div>
                </div>
            </div>

            <!-- ЛЕГЕНДА И ИНСАЙТ -->
            <div style="display: flex; flex-direction: column; gap: 20px;">
              
                <!-- Легенда -->
                <div class="card" style="padding: 20px;">
                    <h3 style="margin-bottom: 15px; font-size: 1.4rem; color: #fff;">ЛЕГЕНДА</h3>
                  
                    <div style="display: flex; flex-direction: column; gap: 15px;">
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <div style="width: 24px; height: 24px; background: #ffffff; border-radius: 4px; box-shadow: 0 0 10px rgba(198, 255, 0, 0.4);"></div>
                            <div>
                                <div style="font-size: 1.3rem; color: #ffffff; font-weight: bold;">Нет пятерочек</div>
                            </div>
                        </div>

                        <div style="display: flex; align-items: center; gap: 10px;">
                            <div style="width: 24px; height: 24px; background: #C6FF00; border-radius: 4px; border: 1px solid #999;"></div>
                             <div>
                                <div style="font-size: 1.3rem; color: #ffffff; font-weight: bold;">Есть пятерочки</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Статистика по датам -->
                <div class="card" style="padding: 20px; flex: 1; display: flex; flex-direction: column;">
                    <div style="overflow-x: auto; flex: 1; display: flex; flex-direction: column;">
                        <table style="width: 100%; border-collapse: collapse; font-size: 1.4rem; height: 100%; display: flex; flex-direction: column;">
                            
                            <!-- ЗАГОЛОВОК -->
                            <thead>
                                <!-- Добавлено display: flex для строки заголовка, чтобы она вела себя так же, как строки тела -->
                                <tr style="border-bottom: 1px solid var(--accent); display: flex; width: 100%;">
                                    <!-- Установлено flex: 1 для равной ширины (50%) -->
                                    <th style="flex: 1; text-align: center; padding: 8px; color: #ffffff; border-right: 1px solid #333;">Дата открытия</th>
                                    <th style="flex: 1; text-align: center; padding: 8px; color: #ffffff;">Кол-во строк</th>
                                </tr>
                            </thead>

                            <!-- ТЕЛО ТАБЛИЦЫ -->
                            <tbody style="flex: 1; display: flex; flex-direction: column;">
                                
                                <tr style="border-bottom: 1px solid #333; flex: 1; display: flex; align-items: center; width: 100%;">
                                    <!-- Заменено width: 60% на flex: 1, чтобы было ровно по центру (50%) -->
                                    <td style="flex: 1; text-align: center; padding: 10px; border-right: 1px solid #333;">Средние</td>
                                    <td style="flex: 1; text-align: center; padding: 8px; font-weight: bold; color: #fff;">34 тыс.</td>
                                </tr>

                                <tr style="border-bottom: 1px solid #333; flex: 1; display: flex; align-items: center; width: 100%;">
                                    <td style="flex: 1; text-align: center; padding: 10px; border-right: 1px solid #333;">Новый</td>
                                    <td style="flex: 1; text-align: center; padding: 8px; font-weight: bold; color: #fff;">21 тыс.</td>
                                </tr>

                                <tr style="border-bottom: 1px solid #333; flex: 1; display: flex; align-items: center; width: 100%;">
                                    <td style="flex: 1; text-align: center; padding: 10px; border-right: 1px solid #333;">Открыт давно</td>
                                    <td style="flex: 1; text-align: center; padding: 8px; font-weight: bold; color: #fff;">6 тыс.</td>
                                </tr>

                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 12. ГИПОТЕЗА -->
    <div class="slide">
        <h2>ГИПОТЕЗА</h2>
        <div class="fill-height flex-center">
            <div class="card" style="padding: 50px; border: 2px solid var(--accent); text-align: center; max-width: 900px; background: rgba(198, 255, 0, 0.02);">
               <h1 style="font-size: 3rem; line-height: 1.4; text-transform: none; text-shadow: none;">
    Соседство с другими магазинами сети бьет по выручке <span style="color: #ea1f41;">старых</span> пятёрочек <span style="color: var(--accent);">сильнее всего</span>
                </h1>
            </div>
        </div>
    </div>

    <!-- 13. МЕХАНИЗМ -->
    <div class="slide">
        <h2>МЕХАНИЗМ</h2>
        <div class="fill-height" style="display: flex; flex-direction: column; justify-content: center; gap: 15px;">
            <div class="card flex-center" style="padding: 20px; border-color: var(--accent);">
                <h3 style="color: var(--accent); margin: 0; font-size: 1.7rem;">СОВРЕМЕННОЕ ОБОРУДОВАНИЕ И ДИЗАЙН</h3>
            </div>
            <div style="text-align: center; color: var(--accent); font-size: 2rem; line-height: 1;">▼</div>
            <div class="card flex-center" style="padding: 15px; border: 1px dashed #555;">
                <p style="margin: 0; font-weight: bold; font-size: 1.6rem;">БОЛЕЕ НОВЫЕ ПЯТЕРОЧКИ ПРИВЛЕКАТЕЛЬНЕЕ СТАРЫХ</p>
            </div>
            <div style="text-align: center; color: var(--accent); font-size: 2rem; line-height: 1;">▼</div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; width: 100%;">
                <div class="card" style="padding: 20px; background: rgba(198, 255, 0, 0.05);">
                    <div style="display: flex; align-items: baseline; gap: 10px; margin-bottom: 10px;">
                        <span style="font-size: 2.5rem; font-weight: 900; color: var(--accent); line-height: 1;">01</span>
                        <b style="font-size: 1.6rem;">БОЛЕЕ НОВЫЕ</b>
                    </div>
                    <p style="font-size: 1.4rem;">Теряют меньше спроса от наличия пятерочек рядом.</p>
                </div>
                <div class="card" style="padding: 20px; background: rgba(255, 85, 85, 0.05); border-color: #ff5555;">
                    <div style="display: flex; align-items: baseline; gap: 10px; margin-bottom: 10px;">
                        <span style="font-size: 2.5rem; font-weight: 900; color: #ff5555; line-height: 1;">02</span>
                        <strong style="font-size: 1.6rem;">СТАРЫЕ</strong>
                    </div>
                    <p style="font-size: 1.4rem;">Теряют больше спроса от наличия пятерочек рядом.</p>
                </div>
            </div>
            <div style="text-align: center; color: var(--accent); font-size: 2rem; line-height: 1;">▼</div>
            <div class="card" style="padding: 20px; text-align: center; border: 2px solid var(--accent); background: rgba(198, 255, 0, 0.02);">
                <p style="font-size: 1.6rem; line-height: 1.4; font-weight: bold; margin: 0;">
                    Наличие пятерочёк рядом <span style="color: var(--accent);">значительнее</span> влияет на выручку <span style="color: #ff5555;">СТАРЫХ</span>, чем на выручку остальных.
                </p>
            </div>
        </div>
    </div>

    <!-- 14. АЛЬТЕРНАТИВНЫЙ МЕХАНИЗМ -->
    <div class="slide">
        <h2>АЛЬТЕРНАТИВНЫЙ МЕХАНИЗМ</h2>
        <div class="fill-height" style="display: flex; flex-direction: column; justify-content: center; gap: 15px;">
          
            <!-- 1. Неполнота информации -->
            <div class="card flex-center" style="padding: 20px; border-color: var(--accent);">
                <div style="text-align: center;">
                    <h3 style="color: var(--accent); margin: 0; font-size: 1.7rem;">НЕПОЛНОТА ИНФОРМАЦИИ</h3>
                    <p style="margin: 10px 0 0 0; font-size: 1.6rem; color: #ccc;">Старые пятерочки открывались с меньшей информацией о местности.</p>
                </div>
            </div>

            <div style="text-align: center; color: var(--accent); font-size: 2rem; line-height: 1;">▼</div>

            <!-- 2. Оптимальная локация -->
            <div class="card flex-center" style="padding: 20px; border: 1px dashed #555;">
                <div style="text-align: center;">
                    <p style="margin: 0; font-weight: bold; font-size: 1.7rem;">ОПТИМАЛЬНАЯ ЛОКАЦИЯ</p>
                    <p style="margin: 5px 0 0 0; font-size: 1.6rem; color: #aaa;">Остальные пятёрочки <span style="color: var(--accent);">оптимальнее</span> выбрали место.</p>
                </div>
            </div>

            <div style="text-align: center; color: var(--accent); font-size: 2rem; line-height: 1;">▼</div>

            <!-- 3. Следствие -->
            <div class="card" style="padding: 20px; text-align: center; border: 2px solid var(--accent); background: rgba(198, 255, 0, 0.02);">
                <p style="font-size: 1.7rem; line-height: 1.4; font-weight: bold; margin: 0;">
                    Рядом стоящие пятёрочки <span style="color: var(--accent);">значительнее</span> снижают выручку старого магазина.
                </p>
            </div>
        </div>
    </div>

    <!-- 15. МИРОВОЙ ОПЫТ (КОНТЕКСТ) -->
    <div class="slide">
        <h2>МИРОВОЙ ОПЫТ</h2>
        <div style="display: grid; grid-template-columns: 1fr; gap: 30px; height: 45vh;">
          
            <!-- Левая часть: Кейсы -->
            <div style="display: flex; flex-wrap: column; gap: 20px;">
              
                <!-- STARBUCKS -->
                <div class="card" style="padding: 25px; border-left: 4px solid #00704A; flex: 1; display: flex; flex-direction: column;">
                    <h3 style="color: #fff; margin-bottom: 10px; font-size: 1.8rem;">Кейс Starbucks</h3>
                    <p style="font-size: 1.7rem; color: #ccc;">
                        На каждую точку приходилось <span style="color: var(--accent);">множество кофеен</span> бренда. Это привело к огромному падению трафика в старых точках.
                    </p>
                    <!-- Источник -->
                    <div style="margin-top: auto; padding-top: 10px; border-top: 1px solid rgba(255,255,255,0.1); font-size: 1.2rem; color: #666; font-style: italic;">
                        Источник: Starbucks Also Faced Issues (2024); <br> Сайт: marketingmaverickhe.io
                    </div>
                </div>

                <!-- SUBWAY -->
                <div class="card" style="padding: 25px; border-left: 4px solid #FFC72C; flex: 1; display: flex; flex-direction: column;">
                    <h3 style="color: #fff; margin-bottom: 10px; font-size: 1.8rem;">Кейс Subway</h3>
                    <p style="font-size: 1.7rem; color: #ccc;">
                        Бесконтрольное открытие франшиз рядом друг с другом вызвало «каннибализацию» прибыли. Сеть закрыла более 7 600 точек с 2015 года.
                    </p>
                    <!-- Источник -->
                    <div style="margin-top: auto; padding-top: 10px; border-top: 1px solid rgba(255,255,255,0.1); font-size: 1.2rem; color: #666; font-style: italic;">
                        Источник: THE DECLINE OF SUBWAY (2025) <br>Сайт: alikhaneats.com
                    </div>
                </div>
            </div>
            
            <!-- Правая часть: Вывод -->
            <!-- <div class="card" style="padding: 30px; border: 2px solid var(--accent); background: rgba(198, 255, 0, 0.05); display: flex; flex-direction: column; justify-content: center;">
                <h3 style="text-align: center; margin-bottom: 20px; color: var(--accent);">ПОЧЕМУ ЭТО ВАЖНО?</h3>
                <p style="font-size: 1.3rem; text-align: center; line-height: 1.5;">
                    Наши данные по Пятерочке (Москва и СПб) подтверждают этот глобальный тренд:
                </p>
                <br>
                <div style="background: rgba(0,0,0,0.4); padding: 20px; border-radius: 8px; border: 1px solid #444;">
                    <p style="font-size: 1.2rem; text-align: center; color: #fff; margin: 0;">
                        «Старые» магазины, как устоявшийся бизнес, <span style="color: #ff5555; font-weight: bold;">теряют ~14.3 млн ₽</span> выручки из-за открытия конкурента под боком.
                    </p>
                </div>
                 <div style="margin-top: 20px; font-size: 1.1rem; color: #666; text-align: center;">
                    * Расчет на основе T-test (Welch’s) по фильтрованной выборке (Москва/СПб)
                </div>
            </div> -->
        </div>
    </div>

    <!-- 16. МАТ-МОДЕЛЬ -->
    <div class="slide" id="chartSlide3">
        <h2>МАТ-МОДЕЛЬ</h2>
      
        <div style="display: grid; grid-template-columns: 500px 1fr; gap: 30px; height: 75vh;">
          
            <!-- ЛЕВАЯ КОЛОНКА: СТАТИСТИКА И ТЕОРИЯ -->
            <div style="display: flex; flex-direction: column; gap: 20px;">
              
                <!-- Описание метода -->
                <div class="card" style="padding: 20px; border-left: 4px solid var(--accent);">
                    <h3 style="color: #fff; margin-bottom: 10px;">Методология</h3>
                    <p style="font-size: 1.3rem; color: #ccc; margin-bottom: 15px;">
                        Используется <strong>t-тест Уэлча</strong> (для независимых выборок с неравными дисперсиями).
                    </p>
                  
                    <div style="background: rgba(255,255,255,0.05); padding: 12px; border-radius: 6px; border: 1px solid #444;">
                        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 5px;">
                            <span style="font-size: 1.2rem; font-weight: bold; color: #fff;">Критерий Левена</span>
                        </div>
                        <p style="font-size: 1.2rem; margin: 0; color: #aaa;">
                            P-value < 0.05 <br>
                            <span style="color: var(--accent);">Дисперсии статистически не равны.</span>
                        </p>
                    </div>
                </div>

                <!-- Блок статистики (Численные) -->
                <div class="card" style="padding: 20px; flex: 1; display: flex; flex-direction: column; justify-content: center;">
                    <h3 style="margin-bottom: 15px; text-align: left;">Разницы средних (млн ₽)</h3>
                  
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div>
                            <div style="font-size: 1.1rem; color: #888; text-transform: uppercase; margin-bottom: 5px;">Старые</div>
                            <div style="font-size: 1.7rem; color: #ff5555; font-weight: 900;">-24.6 МЛН ₽</div>
                            <div style="color: #888; font-size: 1.1rem;">(p < 0.001)</div>
                        </div>

                        <div>
                            <div style="font-size: 1.1rem; color: #888; text-transform: uppercase; margin-bottom: 5px;">остальные</div>
                            <div style="font-size: 1.7rem; color: #fff; font-weight: 900;">-6.8 МЛН ₽</div>
                            <div style="color: #888; font-size: 1.1rem;">(p < 0.001)</div>
                        </div>
                    </div>
                </div>

                <!-- Блок статистики (Проценты) -->
                <div class="card" style="padding: 20px; flex: 1; display: flex; flex-direction: column; justify-content: center;">
                    <h3 style="margin-bottom: 15px; text-align: left;">Разницы средних (%)</h3>
                  
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div>
                            <div style="font-size: 1.1rem; color: #888; text-transform: uppercase; margin-bottom: 5px;">Старые</div>
                            <div style="font-size: 1.7rem; color: #ff5555; font-weight: 900;">18.3%</div>
                        </div>

                        <div>
                            <div style="font-size: 1.1rem; color: #888; text-transform: uppercase; margin-bottom: 5px;">Остальные</div>
                            <div style="font-size: 1.7rem; color: #fff; font-weight: 900;">9.5%</div>
                        </div>
                    </div>
                </div>

            </div>

            <!-- ПРАВАЯ КОЛОНКА: 2 ГРАФИКА -->
            <div style="display: flex; flex-direction: column; gap: 20px; height: 100%;">
              
                <!-- ГРАФИК 1: Старые (Сильный эффект) -->
                <div class="card" style="flex: 1; padding: 15px; display: flex; flex-direction: column; overflow: hidden;">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <h4 style="margin: 0; color: var(--accent); font-size: 1.3rem;">1. Выборка: Старые магазины</h4>
                        <span style="font-size: 1.2rem; color: #666;">Сильное влияние</span>
                    </div>
                    <div class="chart-container-fix" style="flex: 1; min-height: 0;">
                        <div id="chart-ttest" style="width: 100%; height: 100%;"></div>
                    </div>
                </div>

                <!-- ГРАФИК 2: Все (Слабый эффект) -->
                <div class="card" style="flex: 1; padding: 15px; display: flex; flex-direction: column; overflow: hidden;">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <h4 style="margin: 0; color: #fff; font-size: 1.3rem;">2. Выборка: Остальные</h4>
                        <span style="font-size: 1.2rem; color: #666;">Слабое влияние</span>
                    </div>
                    <div class="chart-container-fix" style="flex: 1; min-height: 0;">
                        <div id="chart-ttest2" style="width: 100%; height: 100%;"></div>
                    </div>
                </div>

            </div>

        </div>
    </div>

<!-- 17. ПРОВЕРКА НА УСТОЙЧИВОСТЬ -->
    <div class="slide" id="chartSlide4">
        <h2>ПРОВЕРКА НА УСТОЙЧИВОСТЬ</h2>
        
        <div style="display: grid; grid-template-columns: 1.4fr 1fr; gap: 30px; height: 80vh;">
            
            
            <!-- ЛЕВАЯ КОЛОНКА: ТАБЛИЦЫ -->
            <!-- 1. justify-content: center — выравнивает карточки по вертикали по центру -->
            <div class="card" style="display: flex; flex-direction: column; gap: 10px; height: 100%; justify-content: center; padding: 0">
                
                <!-- ТАБЛИЦА 1 -->
                <!-- 2. Убрали flex: 1, чтобы карточка не растягивалась, а была по размеру таблицы -->
                <div style="padding: 12px 15px 12px 15px; display: flex; flex-direction: column; gap: 0px;">
                    <h3 style="color: #fff; margin: 0px 0px -5px 0px; font-size: 1.4rem; font-weight: 600">Разница* средней выручки между наличием и отсутствием пятерочек рядом по группам:</h3>
                </div>
                <div class="card" style="padding: 15px; display: flex; flex-direction: column; gap: 10px;">
                    <h3 style="color: #fff; margin: 0 0 5px 0; font-size: 1.3rem; font-weight: 100;">Группировка по площади</h3>
                    <div style="width: 100%;">
                        <table style="width: 100%; border-collapse: collapse; font-size: 1.1rem; text-align: center;">
                            <thead>
                                <tr style="border-bottom: 2px solid var(--accent);">
                                    <th style="font-size: 1.1em; padding: 8px; text-align: left;">Группа</th>
                                    <th style="padding: 8px; font-size: 1.1em">Разница<br><span style="font-size: 0.9em; color: #888; font-weight: normal;">(старые)</span></th>
                                    <th style="padding: 8px; font-size: 1.1em">%</th>
                                    <th style="padding: 8px; font-size: 1.1em">Разница<br><span style="font-size: 0.9em; color: #888; font-weight: normal;">(остальные)</span></th>
                                    <th style="padding: 8px; font-size: 1.1em">%</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr style="border-bottom: 1px solid #333">
                                    <td style="padding: 8px; text-align: left; font-weight: bold; color: #fff;">Маленькие</td>
                                    <td>11.0м</td>
                                    <td style="color: var(--accent);">17.5%</td>
                                    <td>5.9м</td>
                                    <td style="color: var(--accent);">11.4%</td>
                                </tr>
                                <tr style="border-bottom: 1px solid #333;">
                                    <td style="padding: 8px; text-align: left; font-weight: bold; color: #fff;">Средние</td>
                                    <td>11.4м</td>
                                    <td style="color: var(--accent);">15.8%</td>
                                    <td>6.0м</td>
                                    <td style="color: var(--accent);">9.2%</td>
                                </tr>
                                <tr style="border-bottom: 1px solid #333;">
                                    <td style="padding: 8px; text-align: left; font-weight: bold; color: #fff;">Большие</td>
                                    <td>19.4м</td>
                                    <td style="color: var(--accent);">14.5%</td>
                                    <td>13.2м</td>
                                    <td style="color: var(--accent);">13.4%</td>
                                </tr>
                                <tr>
                                    <td style="padding: 8px; text-align: left; font-weight: bold; color: #fff;">Очень большие</td>
                                    <td>22.7м</td>
                                    <td style="color: #ff5555;">12.0%</td>
                                    <td>23.0м</td>
                                    <td style="color:#ff5555;">15.7%</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- ТАБЛИЦА 2 -->
                <!-- Тоже убрали flex, карточка занимает ровно столько места, сколько нужно контенту -->
                <div class="card" style="padding: 15px; display: flex; flex-direction: column; gap: 10px;">
                    <h3 style="color: #fff; margin: 0 0 0 0; font-size: 1.3rem; font-weight: 100;">Разбивка по времени открытия</h3>
                    
                    <div style="width: 100%;">
                        <table style="width: 100%; border-collapse: collapse; font-size: 1.1rem; text-align: center;">
                            <thead>
                                <tr style="border-bottom: 2px solid var(--accent);">
                                    <th style="padding: 8px; text-align: left; font-size: 1.1em;">Группа</th>
                                    <th style="padding: 8px; font-size: 1.1em;">Разница<br><span style="font-size: 0.7em; color: #888; font-weight: normal;"></span></th>
                                    <th style="padding: 8px; font-size: 1.1em;">%</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr style="border-bottom: 1px solid #333;">
                                    <td style="padding: 8px; text-align: left; font-weight: bold; color: #fff;">Открыты давно</td>
                                    <td>24.6м</td>
                                    <td style="color: var(--accent);">18.3%</td>
                                </tr>
                                <tr style="border-bottom: 1px solid #333;">
                                    <td style="padding: 8px; text-align: left; font-weight: bold; color: #fff;">Средние по возрасту</td>
                                    <td>9.5м</td>
                                    <td style="color: var(--accent);">12.7%</td>
                                </tr>
                                <tr>
                                    <td style="padding: 8px; text-align: left; font-weight: bold; color: #fff;">Новые</td>
                                    <td>4.9м</td>
                                    <td style="color: var(--accent);">7.6%</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <p style="color: #888; font-size: 1.1rem; margin: 0 0 10px 10px; font-style: italic;">
                    * Разница между средними выручками магазинов, где есть соседние пятёрочки, и магазинов, где их нет. Аналогично предыдущему слайду.
                </p>
            </div>
            
    
<!-- ПРАВАЯ КОЛОНКА: ГРАФИК -->
    <!-- 1. Используем те же стили контейнера, что и слева (padding: 0, gap: 10px) -->
    <div class="card" style="display: flex; flex-direction: column; gap: 10px; height: 100%; justify-content: center; padding: 0;">
        
        <!-- 2. Контейнер для графика (flex: 1, чтобы занять всё свободное место) -->
        <!-- Добавили padding: 10px, чтобы сам график не прилипал к краям, но рамка была внешней -->
        <div style="flex: 1; width: 100%; min-height: 0; padding: 10px;">
                <div id="chart-robustness" style="width: 100%; height: 100%;"></div>
        </div>

        <!-- 3. Примечание (Абсолютно те же стили margin и font, что и слева) -->
        <p style="color: #888; font-size: 1.1rem; margin: 0 0 10px 10px; font-style: italic;">
         Все проверки были статсзначимы с учетом поправки Бонферрони
        </p>
    </div> <!-- Закрывает правую колонку (карточку) -->
    
    </div> <!-- НУЖНО ДОБАВИТЬ: Закрывает Grid-сетку -->
    </div> <!-- НУЖНО ДОБАВИТЬ: Закрывает сам 17-й слайд -->

    <!-- 18. ВЫВОДЫ -->
    <div class="slide">
        <h2>ВЫВОДЫ</h2>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; height: 70vh;">
            <!-- Вывод -->
            <div class="card" style="padding: 30px; display: flex; flex-direction: column; gap: 15px; justify-content: center;">
                <div>              
                      <h3 style="color: var(--accent); margin-bottom: 10px; font-size: 2rem;">Вывод</h3>
                    <p style="font-size: 1.4rem; line-height: 1.4;">
                    Гипотеза подтвердилась для большинства случаев, наличие пятерочки рядом влияет на выручку старых пятёрочек в среднем сильнее, чем для более новых
                    </p>
                </div>
                <div style="display: flex; flex-direction: column; gap: 15px;">              
                      <h3 style="color: var(--accent); margin-bottom: 0; font-size: 2rem;">Устойчивость</h3>
                    <div style="font-size: 1.4rem; line-height: 1.4;">
                        Для очень больших магазинов гипотеза не подтверждается
                    </div>
                    <div style="display: flex; flex-direction: column; gap: 5px; font-size: 1.3rem; line-height: 1.4;">
                        <div class="card" style="padding: 12px 15px;">Очень большие пятёрочки несут большие издержки</div>
                        <div style="text-align: center; color: var(--accent); font-size: 2rem; margin: 0;">↓</div>
                        <div class="card" style="padding: 12px 15px;">При их неэффективности сеть понесёт сильные убытки</div>
                        <!-- <div style="text-align: center; color: var(--accent); font-size: 2rem; margin: 0;">↓</div> -->
                        <div class="card" style="padding: 12px 15px;">В данных только эффективные старые очень большие пятёрочки</div>
                    </div>
                </div>
            </div>
            <!-- Устойчивость -->
            <!-- <div class="card" style="padding: 30px; display: flex; flex-direction: column; justify-content: center;">
                <h3 style="color: var(--accent); margin-bottom: 20px; font-size: 2rem;">Устойчивость</h3>
                 <p style="font-size: 1.4rem; line-height: 1.4;">
                    При проверке на устойчивость выявлено влияние по категории населения
                </p>
            </div> -->
            <!-- Ограничения -->
            <div class="card" style="padding: 30px; background: rgba(255, 85, 85, 0.05); border-color: #ff5555; display: flex; flex-direction: column; justify-content: center;">
                <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 20px; border-bottom: 1px solid rgba(255, 85, 85, 0.3); padding-bottom: 15px;">
                    <h3 style="margin: 0; color: #ff5555; font-size: 2rem;">ОГРАНИЧЕНИЯ</h3>
                </div>
                <ul style="font-size: 1.4rem; list-style: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 15px;">
                    <li><strong style="color: #ff5555;">• Ошибка выжившего:</strong> Большинство старых неэффективных точек уже закрыты.</li>
                    <li><strong style="color: #ff5555;">• Датасет:</strong> Нет данных о расходах, данные о населении недостаточно точны.</li>
                    <li><strong style="color: #ff5555;">• География:</strong> Нет точных координат для использования реального расстояния.</li>
                    <li><strong style="color: #ff5555;">• Статика в панельных данных:</strong> данные инфраструктуры не меняются в течение года.</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- 19. ПОЛИСИ -->
    <div class="slide">
        <h2>Policy Implication</h2>
        <div class="fill-height flex-center">
            <div class="card" style="width: 100%; height: 70vh; display: grid; grid-template-columns: 1fr 1fr; grid-template-rows: 1fr 1fr; gap: 20px; padding: 30px; text-align: left;">
              
                <!-- 1. ПОЛИТИКА ФРАНШИЗЫ -->
                <div style="background: rgba(255,255,255,0.05); padding: 20px 40px; border-radius: 10px; display: flex; align-items: center; border-left: 6px solid #cf0022">
                    <div>
                        <h3 style="color: #cf0022; margin-bottom: 10px;">ПОЛИТИКА ФРАНШИЗЫ</h3>
                        <p style="font-size: 1.4rem; line-height: 1.4; margin: 0;">
                            Открывать вторую точку рядом может быть выгодно. Общая прибыль сети растет, даже если доходы первой немного упадут.
                        </p>
                    </div>
                </div>

                <!-- 2. ДЛЯ ФРАНЧАЙЗИ -->
                <div style="background: rgba(255,255,255,0.05); padding: 20px 40px; border-radius: 10px; display: flex; align-items: center; border-left: 6px solid #ff4081;">
                    <div>
                        <h3 style="color: #ff4081; margin-bottom: 10px;">ДЛЯ ФРАНЧАЙЗИ</h3>
                        <p style="font-size: 1.4rem; line-height: 1.4; margin: 0;">
                            Иметь в договоре с франшизой ограничение на число точек рядом
                        </p>
                    </div>
                </div>

                <!-- 3. ПОЛИТИКА ДЛЯ X5 -->
                <div style="grid-column: span 2; background: rgba(255,255,255,0.05); padding: 20px 40px; border-radius: 10px; display: flex; align-items: center; border-left: 6px solid #C6FF00; width: 60%; justify-self: center;">
                    <div>
                        <h3 style="margin-bottom: 10px;"><span style="color: var(--accent);">ПОЛИТИКА ДЛЯ X5</span></h3>
                        <p style="font-size: 1.4rem; line-height: 1.4; margin: 0; ">
                            Если выручка старой точки снизилась из-за соседней, то это может быть сигналом о необходимости уменьшить издержки магазина<br>
                        </p>
                    </div>
                </div>

                <!-- 4. СТРАТЕГИЯ -->
                <!-- <div style="background: rgba(255,255,255,0.05); padding: 20px 40px; border-radius: 10px; display: flex; align-items: center; border-left: 6px solid #888;">
                    <div>
                        <h3 style="color: #ccc; margin-bottom: 10px;">СТРАТЕГИЯ</h3>
                        <p style="font-size: 1.4rem; line-height: 1.4; margin: 0;">
                            Гипотеза подтверждает, что клиенты менее лояльны к старым пятёрочкам -> их можно использовать как ранний индикатор. <br> Новая политика вредит -> старые упадут первыми. <br> Политика работает -> старые быстрее покажут рост.
                        </p>
                    </div>
                </div> -->

            </div>
        </div>
    </div>

<!-- 20. КОМАНДА (GAME HUB) -->
<div class="slide" id="teamSlide">
    <h2>КОМАНДА</h2>
    
    <!-- Контейнер: Слева Игра, Справа Меню -->
    <div class="game-hub-layout">
        
        <!-- ЛЕВАЯ ЧАСТЬ: ИГРОВАЯ ЗОНА -->
        <div class="game-stage">
            
            <!-- 1. РЕЖИМ: КАЗИК (По умолчанию видим) -->
            <div id="mode-casino" class="game-mode active">
                <div class="fill-height" style="justify-content: center; align-items: center; position: relative; z-index: 5;">
                    <!-- SLOT MACHINE CONTAINER -->
                    <div class="slot-machine-frame">
                        <div class="slot-grid">
                            <!-- ROW 1 -->
                            <div class="slot-cell"><div class="team-photo-box slot-img" style="background-image: url('images/pudge.png');"></div></div>
                            <div class="slot-cell"><div class="team-photo-box slot-img" style="background-image: url('images/sf.png');"></div></div>
                            <div class="slot-cell"><div class="team-photo-box slot-img" style="background-image: url('images/tinker.png');"></div></div>
                            <div class="slot-cell"><div class="team-photo-box slot-img" style="background-image: url('images/viper.png');"></div></div>
                            <div class="slot-cell"><div class="team-photo-box slot-img" style="background-image: url('images/max.jpg');"></div></div>
                            <div class="slot-cell"><div class="team-photo-box slot-img" style="background-image: url('images/knazyv.jpg');"></div></div>
                            <!-- ROW 2 -->
                            <div class="slot-cell active-row"><div class="team-photo-box slot-img" style="background-image: url('images/tete.jpg');"></div><div class="role-label">SUPPORT</div></div>
                            <div class="slot-cell active-row"><div class="team-photo-box slot-img" style="background-image: url('images/photo_2025-12-09_11-27-57.jpg');"></div><div class="role-label">HARD SUPP</div></div>
                            <div class="slot-cell"><div class="team-photo-box slot-img" style="background-image: url('images/Bounty_Hunter.png');"></div></div>
                            <div class="slot-cell"><div class="team-photo-box slot-img" style="background-image: url('images/gg_wp.jpg');"></div></div>
                            <div class="slot-cell"><div class="team-photo-box slot-img" style="background-image: url('images/grahs.jpg');"></div></div>
                            <div class="slot-cell"><div class="team-photo-box slot-img" style="background-image: url('images/pushko.png');"></div></div>
                            <!-- ROW 3 -->
                            <div class="slot-cell"><div class="team-photo-box slot-img" style="background-image: url('images/penis.jpg');"></div></div>
                            <div class="slot-cell"><div class="team-photo-box slot-img" style="background-image: url('images/photo_2025-10-09_21-09-55.jpg');"></div></div>
                            <div class="slot-cell"><div class="team-photo-box slot-img" style="background-image: url('images/photo_2025-12-09_11-27-21.jpg');"></div></div>
                            <div class="slot-cell"><div class="team-photo-box slot-img" style="background-image: url('images/photo_2025-12-12_16-32-37.jpg');"></div></div>
                            <div class="slot-cell"><div class="team-photo-box slot-img" style="background-image: url('images/photo_2025-12-14_14-53-28.jpg');"></div></div>
                            <div class="slot-cell"><div class="team-photo-box slot-img" style="background-image: url('images/photo_2020-02-16_19-15-52.jpg');"></div></div>
                        </div>
                        <div class="lights-top"></div>
                        <div class="lights-bottom"></div>
                    </div>
                    
                    <div style="margin-top: 30px; text-align: center;">
                        <button id="casinoBtn" class="casino-btn" onclick="playCasino()">🎰 ДЕПАТЬ 🎰</button>
                    </div>
                </div>
            </div>

            <!-- 2. РЕЖИМ: АНГРИ БЕРТС -->
            <div id="mode-birds" class="game-mode" style="display: none; position: relative;">
                <div id="birds-container" style="width: 100%; height: 100%; overflow: hidden;"></div>
                
                <!-- Интерфейс -->
                <div style="position: absolute; top: 20px; left: 20px; z-index: 10; display: flex; gap: 10px;">
                    <button onclick="initBirds()" class="casino-btn" style="font-size: 0.8rem; padding: 10px 15px;">🔄 RESTART GAME</button>
                    <div id="level-indicator" style="background: rgba(0,0,0,0.7); color: #C6FF00; padding: 10px; border-radius: 5px; font-weight: bold; font-family: 'Monument Extended', sans-serif;">
                        LEVEL 1
                    </div>
                </div>
                
                <!-- Сообщение о победе / Следующий уровень -->
                <div id="birds-msg" style="display: none; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; z-index: 20;">
                    <h1 style="font-size: 3rem; color: #C6FF00; text-shadow: 0 0 20px #000; margin-bottom: 20px;">CLEARED!</h1>
                    <button id="next-level-btn" onclick="nextLevel()" class="casino-btn" style="font-size: 1.2rem;">NEXT LEVEL ➡</button>
                </div>
            </div>

            <!-- 3. РЕЖИМ: ЗОБМИ И ОФОЩИ (Заглушка) -->
            <div id="mode-zombies" class="game-mode" style="display: none;">
                <div class="card flex-center" style="height: 100%; border: 4px dashed #C6FF00; background: rgba(198, 255, 0, 0.1);">
                    <div>
                        <h1 style="font-size: 4rem; margin-bottom: 20px;">🧟‍♂️ ЗОБМИ И ОФОЩИ</h1>
                        <p style="font-size: 2rem;">Planting Peas...</p>
                        <p style="color: #666;">(Code coming soon)</p>
                    </div>
                </div>
            </div>

        </div>

        <!-- ПРАВАЯ ЧАСТЬ: МЕНЮ ВЫБОРА -->
        <div class="game-menu-sidebar">
            <h3 style="text-align: center; margin-bottom: 20px; color: #fff; border-bottom: 1px solid #333; padding-bottom: 10px;">ВЫБОР РЕЖИМА</h3>
            
            <button class="game-select-btn active" onclick="switchGameMode('casino', this)">
                <span class="g-icon">🎰</span>
                <span class="g-text">казик</span>
            </button>

            <button class="game-select-btn" onclick="switchGameMode('birds', this)">
                <span class="g-icon">🐦</span>
                <span class="g-text">ангри бертс</span>
            </button>

            <button class="game-select-btn" onclick="switchGameMode('zombies', this)">
                <span class="g-icon">🧟</span>
                <span class="g-text">зобми и офощи</span>
            </button>
        </div>

    </div>

    <!-- Общие элементы для эффектов (оставляем в корне слайда или body) -->
    <div id="money-rain-container"></div>
    <div id="win-message" style="display:none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 2000; text-align: center; pointer-events: none;"></div>
    
    <!-- AUDIO -->
    <audio id="casinoSound" src="sound/roulette-play_fyk7stv_.mp3" preload="auto"></audio>
    <audio id="jackpotSound" src="sound/djekpot-rd.mp3" preload="auto"></audio>
    <audio id="winSound" src="sound/3923cb8ada7ca47.mp3" preload="auto"></audio>
</div>

    <!-- ФИНАЛ -->
    <div class="slide flex-center">
        <img src="images/pudge.png" style="position: absolute; top: 0; left: 30%; width: 70%; height: 100%; object-fit: cover; opacity: 0.25; z-index: 0; pointer-events: none;" alt="Pudge">
        <div style="position: relative; z-index: 1;">
            <h1 style="font-size: 4.5rem;">GG WP</h1>
            <p style="color: var(--accent); font-size: 1.6rem;">THANKS FOR WATCHING</p>
            <div style="margin-top: 40px;">
                <img src="images/Team_Spirit_new_em.svg" alt="TS Logo" style="filter: brightness(0) invert(1); width: 150px; opacity: 0.6;">
            </div>
        </div>
    </div>
    <div class="slide flex-center">
        <div class="card" style="max-width: 900px; padding: 40px; font-size: 1.6rem; line-height: 1.5; text-align: center;">
           Скорее всего, конкурентное давление присутствует в обеих группах (и там где есть соседи, и там где их нет). Поэтому при сравнении средних этот внешний шум взаимоуничтожается, и мы видим чистый эффект именно от соседства с "своими" магазинами
        </div>
    </div>
    <div class="slide">
        <!-- <h2>Распределение масчтаба</h2> -->
        <div class="fill-height flex-center">
            <img src="images/Podval1.jpg" alt="Photo" style="max-width: 80%; max-height: 70vh; border-radius: 15px; box-shadow: 0 0 20px rgba(0,0,0,0.5);">
        </div>
    </div>
    <!-- НОВЫЙ СЛАЙД С ФОТО -->
    <div class="slide">
        <h2>Влияние пятерочек</h2>
        <div class="fill-height flex-center">
            <img src="images/photo_2025-12-14_14-53-28.jpg" alt="Photo" style="max-width: 80%; max-height: 70vh; border-radius: 15px; box-shadow: 0 0 20px rgba(0,0,0,0.5);">
        </div>
    </div>
        
<!-- 24. ПОДОБНЫЕ ИССЛЕДОВАНИЯ (АКАДЕМИЧЕСКАЯ БАЗА) -->
    <div class="slide">
        <h2>Подобные исследования</h2>
        <div class="fill-height" style="display: flex; flex-direction: column; justify-content: center; gap: 30px;">
            
            <!-- Исследование 1 -->
            <div class="card" style="padding: 30px; border-left: 6px solid var(--accent); background: rgba(198, 255, 0, 0.05);">
                <div style="font-size: 1.2rem; color: #888; margin-bottom: 5px; font-family: 'Courier New', monospace;">Pancras, Sriram & Kumar (2012)</div>
                <h3 style="color: #fff; margin-bottom: 15px; font-size: 1.8rem;">Retail Expansion and Cannibalization Effects</h3>
                <p style="font-size: 1.4rem; color: #ddd; line-height: 1.5;">
                    Авторы математически моделируют компромисс между захватом рынка и каннибализацией собственных продаж.
                    <br><br>
                    <span style="color: var(--accent); font-weight: bold;">Суть:</span> Подтверждают, что при уплотнении сети «старые» магазины неизбежно теряют выручку. Однако, если потеря выручки старого магазина меньше, чем выручка нового, - стратегия считается успешной.
                </p>
            </div>

            <!-- Исследование 2 -->
            <div class="card" style="padding: 30px; border-left: 6px solid #fff;">
                <div style="font-size: 1.2rem; color: #888; margin-bottom: 5px; font-family: 'Courier New', monospace;">Barrie R. Nault, Mohammad S. Rahman</div>
                <h3 style="color: #fff; margin-bottom: 15px; font-size: 1.8rem;">Proximity to a Traditional Physical Store: Cannibalization and Complementarity</h3>
                <p style="font-size: 1.4rem; color: #ddd; line-height: 1.5;">
                    Авторы второй статьи пришли к похожему выводу (на второе полиси), но через идею о предельной выгоде магазина для сети, что она может использовать аномально высокую каннибализацию конкретных магазинов как диагностический сигнал о сниженной конкурентоспособности точки, что в управленческой практике может указывать на необходимость изменений формата или клиентского опыта.
                </p>
            </div>

        </div>
    </div>

  

    <!-- ПРИЛОЖЕНИЕ: ГРАФИКИ -->
    <div class="slide">
        <h2>ПРИЛОЖЕНИЕ: ВЛИЯНИЕ ДРУГИХ ФАКТОРОВ</h2>
        <div style="display: flex; flex-direction: column; height: 75vh; gap: 20px;">
            <div class="card" style="flex: 1; padding: 10px; display: flex; justify-content: center; align-items: center; background: #000;">
                <!-- Сохрани график из питона как appendix_plots.png и положи в images -->
                <img src="images/appendix_plots.png" alt="Графики корреляций" style="max-width: 100%; max-height: 100%; object-fit: contain;">
            </div>
            <div style="display: flex; gap: 20px;">
                <div class="card" style="flex: 1; padding: 15px;">
                    <h4 style="color: var(--accent);">Средний чек</h4>
                    <p style="font-size: 1.3rem; color: #aaa;">В Москве и СПб чеки почти одинаковы (медиана ~1200₽). Выручка падает из-за оттока трафика, а не снижения цен.</p>
                </div>
                <div class="card" style="flex: 1; padding: 15px;">
                    <h4 style="color: var(--accent);">Инфраструктура</h4>
                    <p style="font-size: 1.3rem; color: #aaa;">Линейная связь с площадью магазина. Школы и остановки влияют слабо (много шума).</p>
                </div>
            </div>
        </div>
    </div>

    <!-- 19. BOXPLOTS -->
    <div class="slide">
        <h2>Боксы-коксы</h2>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; height: 70vh;">
            <img src="boxplot1.png" alt="Boxplot 1" style="max-width: 100%; max-height: 100%; object-fit: contain;">
            <img src="boxplot2.png" alt="Boxplot 2" style="max-width: 100%; max-height: 100%; object-fit: contain;">
        </div>
    </div>

  
    <!-- 20. all-cors -->
    <div class="slide">
        <h2>Все корреляции</h2>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; height: 70vh;">
            <img src="images\123421.jpg" alt="Boxplot 1" style="max-width: 130%; max-height: 130%; object-fit: contain;">
        </div>
    </div>

    <!-- 21. ну неважно -->
    <div class="slide">
        <h2>Выстрел из пушки типо</h2>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; height: 70vh;">
            <img src="images/pushko.png" alt="Boxplot 1" style="max-width: 200%; max-height: 200%; object-fit: contain;">
        </div>
    </div>

    <!-- 22. ну неважно -->
    <div class="slide">
        <h2>Количество данных</h2>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; height: 70vh;">
            <img src="images/doki.png" alt="Boxplot 1" style="max-width: 130%; max-height: 130%; object-fit: contain;">
        </div>
    </div>

    <!-- 23. ну неважно -->
    <div class="slide">
        <h2>Попытка в линрег</h2>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; height: 70vh;">
            <img src="images/popitka_linreg.png" alt="Boxplot 1" style="max-width: 130%; max-height: 80%; object-fit: contain;">
        </div>
    </div>

    <div id="resurrection-explosion"></div>
  
    <!-- ================= CONTROLS & JS ================= -->
    <!-- Controls removed -->

    <script>
    // ==========================================
    // ГЛОБАЛЬНЫЕ ПЕРЕМЕННЫЕ ДЛЯ ГРАФИКОВ
    // ==========================================
    let chartSettlements, chartRobustness;
    let chartAvgCheck, chartMiniRevenue, chartAgeRevenue;
    let chartAreaAge;
    // Переменная chartScatter удалена, так как заменена на картинку

    const ACCENT_COLOR = '#C6FF00'; 
    const TEXT_COLOR = '#ffffff';

    // Общие настройки графиков
    const commonOptions = {
        chart: {
            background: 'transparent',
            toolbar: { show: false },
            animations: { enabled: true, easing: 'easeinout', speed: 800 },
            fontFamily: 'Inter, sans-serif',
        },
        theme: { mode: 'dark' },
        colors: [ACCENT_COLOR, '#444444'],
        grid: { borderColor: '#333', strokeDashArray: 4 },
        dataLabels: { 
            enabled: false,
            style: {
                fontSize: '20px', // УВЕЛИЧЕНО
                fontWeight: 'bold',
            }
        },
        stroke: { curve: 'smooth', width: 4 }, 
      
        // Глобальное увеличение шрифтов осей
        xaxis: {
            labels: {
                style: {
                    fontSize: '18px', // УВЕЛИЧЕНО
                    fontFamily: 'Inter, sans-serif',
                    fontWeight: 600,
                    colors: '#888'
                }
            },
            title: {
                style: {
                    fontSize: '20px', // УВЕЛИЧЕНО
                    fontWeight: 700,
                    color: '#fff'
                }
            }
        },
        yaxis: {
            labels: {
                style: {
                    fontSize: '18px', // УВЕЛИЧЕНО
                    fontFamily: 'Inter, sans-serif',
                    fontWeight: 600,
                    colors: '#888'
                }
            },
            title: {
                style: {
                    fontSize: '20px', // УВЕЛИЧЕНО
                    fontWeight: 700,
                    color: '#fff'
                }
            }
        },
        legend: {
            fontSize: '20px', // УВЕЛИЧЕНО
            fontWeight: 600,
            labels: {
                colors: '#fff'
            }
        },
        tooltip: {
            style: {
                fontSize: '18px' // УВЕЛИЧЕНО
            }
        }
    };

    // СЛАЙД 3: СРЕДНИЙ ЧЕК (Вспомогательный график, но переменная chartAvgCheck)
    const optionsAvgCheck = {
        ...commonOptions,
        series: [{
            name: 'Средний чек',
            data: [1319, 969, 937, 776]
        }],
        chart: { 
            type: 'bar', 
            height: '100%', 
            background: 'transparent', 
            toolbar: { show: false }, 
            animations: { enabled: true } 
        },
        grid: {
            padding: { bottom: 10, left: 10, right: 20 }
        },
        plotOptions: { 
            bar: { 
                borderRadius: 4, 
                horizontal: true, 
                barHeight: '60%',
                distributed: true 
            } 
        },
        colors: [ACCENT_COLOR, '#aeea00', '#96d000', '#7cb300'],
        xaxis: { 
            categories: ['Открыт давно', 'Средний возраст', 'Недавно открытый', 'Новый'],
            title: { text: 'Средняя выручка за месяц', style: { color: '#888', fontSize: '16px', fontWeight: 'bold' } },
            labels: { 
                style: { colors: '#888', fontSize: '14px' },
            },
            axisBorder: { show: false },
            axisTicks: { show: false }
        },
        yaxis: {
            labels: { 
                style: { colors: '#ffffff', fontSize: '16px', fontWeight: 'bold' },
                maxWidth: 200
            }
        },
        tooltip: { theme: 'dark', y: { formatter: (val) => val + " ₽" } },
        legend: { show: false }
    };

    // ГИСТОГРАММА (БИННИНГ)
    function createHistogramData(dataArray) {
        const nums = dataArray.map(v => parseFloat(v)).filter(v => !isNaN(v));
        if (nums.length === 0) return { categories: [], data: [] };

        const minVal = Math.min(...nums);
        const maxVal = Math.max(...nums);
        const step = 3000000; 

        const start = Math.floor(minVal / step) * step;
        const end = Math.ceil(maxVal / step) * step;

        const categories = [];
        const binsCount = Math.round((end - start) / step) + 1;
        const bins = new Array(binsCount).fill(0);

        for (let i = 0; i < binsCount; i++) {
            const currentVal = start + (i * step);
            const label = new Intl.NumberFormat('en-US', { 
                notation: "compact", 
                compactDisplay: "short",
                maximumFractionDigits: 1 
            }).format(currentVal);
            categories.push(label);
        }

        nums.forEach(num => {
            let bucketIndex = Math.floor((num - start) / step);
            if (bucketIndex < 0) bucketIndex = 0;
            if (bucketIndex >= binsCount) bucketIndex = binsCount - 1;
            bins[bucketIndex]++;
        });

        return { categories, data: bins };
    }

    // ЗАГОТОВКА ДЛЯ ГИСТОГРАММЫ
    const optionsBarSettlements = {
        ...commonOptions,
        series: [{ name: 'Магазинов', data: [] }],
        chart: { type: 'bar', height: '100%', background: 'transparent', toolbar: { show: false }, animations: { enabled: true } },
        plotOptions: { bar: { borderRadius: 0, horizontal: false, columnWidth: '100%' } },
        grid: { borderColor: '#333', strokeDashArray: 4, padding: { bottom: 30, left: 10, right: 10 } },
        xaxis: { 
            categories: [], 
            title: { text: 'Выручка', offsetY: -5, style: { color: '#ffffff', fontSize: '20px', fontWeight: 'bold' } },
            labels: { 
                show: true, rotate: -45, style: { colors: '#888', fontSize: '16px' },
                formatter: function(val, timestamp, opts) {
                    if (opts && typeof opts.i !== 'undefined') {
                        if (opts.i % 8 === 0) return val; 
                        return ''; 
                    }
                    return val;
                }
            }, 
            axisBorder: { show: false }, axisTicks: { show: false } 
        },
        yaxis: {
            min: 0,
            title: { text: 'Количество', style: { color: '#ffffff', fontSize: '20px', fontWeight: 'bold' } },
            labels: { style: { colors: '#888', fontSize: '16px' } }
        },
        colors: [ACCENT_COLOR],
        tooltip: { theme: 'dark', y: { formatter: (val) => val + " шт." } }
    };

    // СЛАЙД 6: SCATTER PLOT (Магазины vs Пятерочки)
    // scatterDataMaga is loaded from js/scatter_data.js
    const optionsScatterMaga = {
        ...commonOptions,
        series: [
            {
                name: "Магазины",
                type: "scatter",
                data: scatterDataMaga
            },
            {
                name: "Регрессия",
                type: "line",
                data: [
                    [0, 2.86], 
                    [10, 17.9] 
                ]
            }
        ],
        chart: {
            type: 'line',
            height: '100%',
            background: 'transparent',
            toolbar: { show: false },
            animations: { enabled: false }
        },
        colors: ['rgba(255, 255, 255, 0.6)', '#C6FF00'],
        grid: {
            show: true,
            borderColor: '#333',
            strokeDashArray: 3,
            xaxis: { lines: { show: true } },
            yaxis: { lines: { show: true } }
        },
        legend: {
            show: true,
            position: 'bottom',
            horizontalAlign: 'right',
            floating: true,
            orientation: 'vertical',
            offsetY: 0,
            offsetX: 0,
            fontSize: '20px',
            fontFamily: 'Inter, sans-serif',
            fontWeight: 400,
            labels: {
                colors: '#fff',
                useSeriesColors: false
            },
            markers: {
                width: 12,
                height: 12,
                strokeWidth: 0,
                strokeColor: '#fff',
                fillColors: undefined,
                radius: 12,
                customHTML: undefined,
                onClick: undefined,
                offsetX: 0,
                offsetY: 0
            },
            itemMargin: {
                horizontal: 10,
                vertical: 5
            },
            onItemClick: {
                toggleDataSeries: true
            },
            onItemHover: {
                highlightDataSeries: true
            },
        },
        xaxis: {
            type: 'numeric',
            title: { 
                text: 'Количество пятёрочек', 
                style: { color: '#888', fontSize: '18px', fontWeight: 'bold', fontFamily: 'Inter, sans-serif' } 
            },
            labels: { 
                style: { colors: '#888', fontSize: '14px', fontFamily: 'Inter, sans-serif' },
                formatter: (val) => val.toFixed(0)
            },
            tickAmount: 10,
            min: 0,
            max: 10,
            axisBorder: { show: true, color: '#555' },
            axisTicks: { show: true, color: '#555' }
        },
        yaxis: {
            title: { 
                text: 'Количество магазинов', 
                style: { color: '#888', fontSize: '18px', fontWeight: 'bold', fontFamily: 'Inter, sans-serif' } 
            },
            labels: { 
                style: { colors: '#888', fontSize: '14px', fontFamily: 'Inter, sans-serif' },
                formatter: (val) => val.toFixed(0)
            }
        },
        markers: { size: 4, strokeWidth: 0 },
        stroke: { width: [0, 4] },
        tooltip: { theme: 'dark' }
    };

    // Data for Revenue Chart
    

    // ==========================================
    // СЛАЙД 14: T-TEST Charts
    // ==========================================
    let chartTtest, chartTtest2;

    // Общие настройки стиля для T-test графиков
    const ttestCommonOptions = {
        chart: {
            type: 'boxPlot',
            height: '100%',
            background: 'transparent',
            toolbar: { show: false },
            animations: { enabled: true }
        },
        colors: ['#008FFB', '#FF4560'],
        plotOptions: {
            boxPlot: {
                colors: { upper: '#008FFB', lower: '#008FFB' }
            }
        },
        stroke: {
            colors: ['#ccc'],
            width: 1 // Уменьшили толщину линий
        },
        grid: {
            borderColor: '#333',
            strokeDashArray: 4,
            yaxis: { lines: { show: true } },
            padding: { top: 0, bottom: 0 }
        },
        markers: {
            size: 8, // Увеличили размер точек
            strokeWidth: 0,
            hover: { size: 10 }
        },
        legend: { show: false },
        tooltip: {
            theme: 'dark',
            shared: true,
            intersect: false
        }
    };

// ГРАФИК 1: СТАРЫЕ МАГАЗИНЫ
    const optionsTtest = {
        ...ttestCommonOptions,
        series: [
            {
                name: 'Доверительный интервал (95%)',
                type: 'boxPlot',
                data: [
                    { x: 'Без Пятерочек', y: [131.98, 134.77, 134.77, 134.77, 137.56] },
                    { x: 'С Пятерочками', y: [108.65, 110.18, 110.18, 110.18, 111.70] }
                ]
            },
            {
                name: 'Среднее значение',
                type: 'scatter',
                data: [
                    { x: 'Без Пятерочек', y: 134.77 },
                    { x: 'С Пятерочками', y: 110.18 }
                ]
            }
        ],
        xaxis: {
            categories: ['Без Пятерочек', 'С Пятерочками'],
            labels: {
                style: { colors: '#fff', fontSize: '16px', fontWeight: 'bold' } 
            },
            tooltip: { enabled: false }
        },
        yaxis: {
            title: {
                text: ['Средняя выручка', 'в месяц'],
                style: { color: '#fff', fontSize: '16px' },
                // ИЗМЕНЕНИЕ: Сдвигаем текст влево
                offsetX: -10 
            },
            labels: {
                style: { colors: '#888', fontSize: '16px' },
                formatter: (val) => val.toFixed(0) + "M"
            },
            min: 60, 
            max: 150,
            tickAmount: 5
        },
        grid: {
            // ИЗМЕНЕНИЕ: Добавляем место слева
            padding: { left: 25 },
            borderColor: '#333',
            strokeDashArray: 4,
            yaxis: { lines: { show: true } }
        },
        tooltip: {
            theme: 'dark',
            y: { formatter: (val) => val + " млн ₽" }
        }
    };

 // ГРАФИК 2: ОБЩАЯ ВЫБОРКА
    const optionsTtest2 = {
        ...ttestCommonOptions,
        series: [
            {
                name: 'Доверительный интервал (95%)',
                type: 'boxPlot',
                data: [
                    { 
                        x: 'Без Пятерочек', 
                        y: [70.87, 71.48, 71.48, 71.48, 72.08] 
                    },
                    { 
                        x: 'С Пятерочками', 
                        y: [64.34, 64.66, 64.66, 64.66, 64.99] 
                    }
                ]
            },
            {
                name: 'Среднее значение',
                type: 'scatter',
                data: [
                    { x: 'Без Пятерочек', y: 71.48 },
                    { x: 'С Пятерочками', y: 64.66 }
                ]
            }
        ],
        xaxis: {
            categories: ['Без Пятерочек', 'С Пятерочками'],
            labels: {
                style: { colors: '#fff', fontSize: '16px', fontWeight: 'bold' }
            },
            tooltip: { enabled: false }
        },
        yaxis: {
            title: {
                text: ['Средняя выручка', 'в месяц'],
                style: { color: '#fff', fontSize: '16px' },
                // ИЗМЕНЕНИЕ: Сдвигаем текст влево
                offsetX: -10
            },
            labels: {
                style: { colors: '#888', fontSize: '16px' },
                formatter: (val) => val.toFixed(0) + "M"
            },
            min: 60, 
            max: 150,
            tickAmount: 5
        },
        grid: {
            // ИЗМЕНЕНИЕ: Добавляем место слева
            padding: { left: 25 },
            borderColor: '#333',
            strokeDashArray: 4,
            yaxis: { lines: { show: true } }
        },
        tooltip: {
            theme: 'dark',
            y: { formatter: (val) => val.toFixed(2) + " млн ₽" }
        }
    };

    // --- ВСТАВИТЬ ЭТО В document.addEventListener('DOMContentLoaded', ...) ---
  
    // Инициализация (вместо chartModel)
    if(document.querySelector("#chart-ttest")) {
        chartTtest = new ApexCharts(document.querySelector("#chart-ttest"), optionsTtest);
        chartTtest.render();
    }

    if(document.querySelector("#chart-ttest2")) {
        chartTtest2 = new ApexCharts(document.querySelector("#chart-ttest2"), optionsTtest2);
        chartTtest2.render();
    }

// СЛАЙД 15: УСТОЙЧИВОСТЬ
    const optionsRobustness = {
        ...commonOptions,
        series: [
            { name: 'Старые магазины', data: [12.34, 19.20, 20.63, 29.37, 65.57] },
            { name: 'Остальные', data: [3.48, 9.10, 15.55, 19.88, 25.98] }
        ],
        chart: { 
            type: 'line', 
            height: '100%', // ИЗМЕНЕНИЕ: Высота 90%
            background: 'transparent', 
            toolbar: { show: false } 
        },
        title: {
            text: 'Количество магазинов поблизости',
            align: 'center',
            style: {
                fontSize: '24px',
                fontWeight: 'bold',
                color: '#888'
            }
        },
        stroke: { curve: 'straight', width: 4 },
        xaxis: { 
            categories: ['1', '2', '3', '4', '5'],
            title: { 
                text: 'Количество магазинов', 
                style: { color: '#fff', fontSize: '16px' },
                offsetY: -10 // Сохранено: ближе к тикам
            },
            labels: { style: { fontSize: '20px', colors: '#888' } }
        },
        yaxis: {
            title: { 
                text: 'Разница* в процентах', 
                style: { color: '#fff', fontSize: '16px' },
                offsetX: -10 // Сохранено: дальше от тиков
            },
            labels: { formatter: (val) => val.toFixed(0) + "%", style: { fontSize: '20px', colors: '#888' } }
        },
        legend: {
            show: true,
            position: 'top',
            horizontalAlign: 'left',
            floating: true,
            fontSize: '20px',
            fontFamily: 'Inter, sans-serif',
            fontWeight: 400,
            labels: {
                colors: '#fff',
                useSeriesColors: false
            },
            markers: {
                width: 12,
                height: 12,
                strokeWidth: 0,
                strokeColor: '#fff',
                radius: 12,
            },
            itemMargin: {
                horizontal: 10,
                vertical: 5
            },
            onItemClick: {
                toggleDataSeries: true
            },
            onItemHover: {
                highlightDataSeries: true
            },
        },
        colors: [ACCENT_COLOR, '#ffffff'],
        annotations: {
            xaxis: []
        }
    };

    // Настройки для графиков 6 слайда (старые, используются в других местах)
    const optionsDistStatic = {
        ...commonOptions,
        chart: { type: 'bar', height: '100%', background: 'transparent', toolbar: { show: false }, animations: { enabled: true } },
        plotOptions: { 
            bar: { 
                borderRadius: 4, 
                columnWidth: '70%',
                dataLabels: { position: 'top' } 
            } 
        },
        dataLabels: { enabled: false },
        yaxis: { 
            title: { text: 'Выручка (x10 млн)', style: { color: '#888', fontSize: '18px' } },
            labels: { style: { colors: '#888', fontSize: '16px' }, formatter: (val) => val.toFixed(1) }
        },
        colors: [ACCENT_COLOR],
        tooltip: { 
            theme: 'dark', 
            y: { formatter: (val) => (val * 10).toFixed(1) + " млн ₽" } 
        }
    };

// ==========================================
    // ДАННЫЕ ДЛЯ 6 СЛАЙДА (РАСПРЕДЕЛЕНИЕ ПО ПЛОЩАДИ И ВОЗРАСТУ)
    // ==========================================
    const optionsAreaAge = {
        ...commonOptions,
        chart: { 
            type: 'bar', 
            height: '100%', 
            background: 'transparent', 
            toolbar: { show: false }, 
            animations: { enabled: true } 
        },
        plotOptions: { 
            bar: { 
                horizontal: true,
                columnWidth: '55%',
                borderRadius: 4,
                dataLabels: {
                    position: 'top' // Метки справа от столбцов
                }
            },
        },
        dataLabels: { 
            enabled: true, 
            offsetX: 30, 
            style: {
                fontSize: '14px',
                colors: ['#fff'], 
                fontWeight: 'bold',
                fontFamily: 'Inter, sans-serif'
            }
        },
        stroke: {
            show: true,
            width: 2,
            colors: ['transparent']
        },
        xaxis: {
            // ДОБАВЛЕНО: Максимум 1700
            max: 1600,
            min: 0,
            tickAmount: 4,
            categories: ['Маленький', 'Средний', 'Большой', ['Очень', 'большой']],
            title: { text: 'Количество', style: { color: '#888', fontSize: '18px' } },
            labels: { style: { colors: '#888', fontSize: '16px' } }
        },
        yaxis: {
            title: { text: 'Площадь магазина', style: { color: '#888', fontSize: '18px' } },
            labels: { style: { colors: '#888', fontSize: '16px' } }
        },
        grid: {
            padding: { right: 50 },
            borderColor: '#333',
            strokeDashArray: 4
        },
        fill: {
            opacity: 1
        },
        tooltip: {
            theme: 'dark',
            y: {
                formatter: function (val) {
                    return val
                }
            }
        },
        legend: {
            show: true,
            position: 'bottom',
            horizontalAlign: 'right',
            floating: true,
            fontSize: '16px',
            fontFamily: 'Inter, sans-serif',
            fontWeight: 600,
            markers: {
                width: 12,
                height: 12,
                radius: 12,
                strokeWidth: 0
            },
            itemMargin: {
                horizontal: 0,
                vertical: 0
            },
            onItemClick: {
                toggleDataSeries: true
            },
            onItemHover: {
                highlightDataSeries: true
            }
        },
        colors: [ACCENT_COLOR, '#ffffff', '#666666'], 
        series: [
            {
                name: 'Новый',
                data: [459, 952, 415, 32]
            },
            {
                name: 'Средний по возрасту',
                data: [651, 1418, 699, 106]
            },
            {
                name: 'Открыт давно',
                data: [41, 133, 257, 121]
            }
        ]
    };
  
    // СЛАЙД 3: РАСПРЕДЕЛЕНИЕ СРЕДНЕГО ЧЕКА
    const checkCats = ["0", "50", "100", "150", "200", "250", "300", "350", "400", "450", "500", "550", "600", "650", "700", "750", "800", "850", "900", "950", "1000", "1050", "1100", "1150", "1200", "1250", "1300", "1350", "1400", "1450", "1500", "1550", "1600", "1650", "1700", "1750", "1800", "1850", "1900", "1950", "2000", "2050", "2100", "2150", "2200", "2250", "2300", "2350", "2400", "2450"];
    const optionsMeanCheck = {
        ...commonOptions,
        chart: { type: 'bar', height: '100%', background: 'transparent', toolbar: { show: false }, animations: { enabled: false } },
        plotOptions: { bar: { borderRadius: 0, columnWidth: '100%', dataLabels: { position: 'top' } } },
        dataLabels: { enabled: false },
        series: [{ name: 'Кол-во чеков', data: [2, 2, 3, 4, 6, 5, 2, 8, 18, 42, 68, 131, 221, 286, 305, 332, 392, 379, 346, 317, 261, 287, 202, 240, 199, 138, 139, 120, 111, 100, 88, 76, 71, 59, 41, 45, 47, 33, 35, 20, 22, 20, 10, 16, 9, 6, 5, 4, 2, 3, 1, 5] }],
        xaxis: {
            categories: checkCats,
            title: { text: '', style: { color: '#666', fontSize: '20px' } },
            labels: { 
                show: true, 
                style: { colors: '#888', fontSize: '16px' }, 
                rotate: -45,
                formatter: (val) => {
                    const num = Number(val);
                    if (isNaN(num)) return val;
                    return (Math.round(num / 300) * 300).toString();
                }
            },
            tickAmount: 12,
            tooltip: { enabled: false }
        },
        yaxis: {
            title: { text: 'Количество', style: { color: '#666', fontSize: '20px' } },
            labels: { style: { colors: '#888', fontSize: '16px' } }
        },
        colors: [ACCENT_COLOR]
    };

    // СЛАЙД 3: РАСПРЕДЕЛЕНИЕ ТРАФИКА
    const trafCats = ["0.0k", "2.8k", "5.6k", "8.4k", "11.2k", "14.0k", "16.8k", "19.6k", "22.4k", "25.2k", "28.0k", "30.8k", "33.6k", "36.4k", "39.2k", "42.0k", "44.8k", "47.6k", "50.4k", "53.2k", "56.0k", "58.8k", "61.6k", "64.4k", "67.2k", "70.0k", "72.8k", "75.6k", "78.4k", "81.2k", "84.0k", "86.8k", "89.6k", "92.4k", "95.2k", "98.0k", "100.8k", "103.6k", "106.4k", "109.2k", "112.0k", "114.8k", "117.6k", "120.4k", "123.2k", "126.0k", "128.8k", "131.6k", "134.4k", "137.2k", "140.0k", "142.8k", "145.6k", "148.4k", "151.2k", "154.0k", "156.8k", "159.6k", "162.4k", "165.2k", "168.0k"];
    const optionsMeanTraf = {
        ...commonOptions,
        chart: { type: 'bar', height: '100%', background: 'transparent', toolbar: { show: false }, animations: { enabled: false } },
        plotOptions: { bar: { borderRadius: 0, columnWidth: '100%', dataLabels: { position: 'top' } } },
        dataLabels: { enabled: false },
        series: [{ name: 'Кол-во магазинов', data: [2, 0, 1, 3, 3, 3, 2, 3, 1, 2, 1, 4, 4, 2, 8, 9, 33, 34, 86, 116, 181, 230, 274, 311, 371, 354, 316, 356, 345, 294, 233, 218, 209, 183, 167, 137, 143, 127, 95, 71, 72, 50, 53, 39, 28, 22, 20, 11, 15, 13, 8, 5, 7, 4, 1, 2, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] }],
        xaxis: {
            categories: trafCats,
            title: { text: '', style: { color: '#666', fontSize: '18px' } },
            labels: { show: true, style: { colors: '#888', fontSize: '12px' }, rotate: -45 },
            tickAmount: 10,
            tooltip: { enabled: false },
        },
        yaxis: {
            title: { text: 'Количество', style: { color: '#666', fontSize: '18px' } },
            labels: { style: { colors: '#888', fontSize: '16px' } }
        },
        colors: [ACCENT_COLOR]
    };

    // СЛАЙД 10: ВЫРУЧКА ПО ДАТАМ ОТКРЫТИЯ (ОБНОВЛЕННЫЙ: 3 КАТЕГОРИИ)
    const optionsAgeRevenue = {
        ...commonOptions,
        series: [
            {
                name: 'Нет Пятерочек (0)',
                // Данные из графика: Новые (64.7M), Средние (76.9M), Старые (134.8M)
                data: [64700000, 76900000, 134800000] 
            },
            {
                name: 'Есть Пятерочки (1)',
                // Данные из графика: Новые (59.7M), Средние (67.4M), Старые (110.2M)
                data: [59700000, 67400000, 110200000]
            }
        ],
        chart: {
            type: 'bar',
            height: '100%',
            background: 'transparent',
            toolbar: { show: false },
            animations: { enabled: true, speed: 1000 }
        },
        plotOptions: {
            bar: {
                horizontal: true,
                dataLabels: { position: 'top' },
                barHeight: '60%',
                borderRadius: 2
            }
        },
        colors: ['#ffffff', '#C6FF00'], 
      
        dataLabels: {
            enabled: true,
            textAnchor: 'start',
            offsetX: 30,
            style: { 
                colors: ['#fff'], 
                fontSize: '18px', 
                fontWeight: 700 
            },
            formatter: function (val) {
                return (val / 1000000).toFixed(1) + "M";
            }
        },
        stroke: { show: true, width: 1, colors: ['#000'] },
        xaxis: {
            // Максимум чуть больше самого большого значения (134.8M)
            max: 150000000, 
            // УБРАЛИ "Новейшие"
            categories: ['Новый', 'Средние', 'Открыт давно'],
            title: { text: 'Средняя выручка за месяц, ₽', style: { color: '#888', fontSize: '17px', fontWeight: 'bold' } },
            labels: {
                style: { colors: '#888', fontSize: '16px' },
                formatter: (val) => (val / 1000000).toFixed(0) + "M"
            },
            axisBorder: { show: false },
            axisTicks: { show: false }
        },
        yaxis: {
            labels: {
                style: { 
                    colors: '#ffffff', 
                    fontSize: '16px', 
                    fontWeight: 'bold',
                    fontFamily: 'Monument Extended, sans-serif'
                },
                maxWidth: 200
            }
        },
        grid: { padding: { right: 100, left: 10 }, borderColor: '#333', strokeDashArray: 4 },
        tooltip: { theme: 'dark', y: { formatter: (val) => new Intl.NumberFormat('ru-RU').format(val) + " ₽" } },
        legend: { show: false }
    };
  
    // СЛАЙД 04.5: BAR CHART CITIES
    const optionsCitiesBar = {
        series: [{
            name: 'Магазинов',
            data: [1481, 544, 381, 317, 282, 270, 260, 249, 246, 242, 227, 222, 179, 159, 125, 100]
        }],
        chart: {
            type: 'bar',
            height: '100%',
            background: 'transparent',
            toolbar: { show: false },
            animations: { enabled: true, speed: 800 }
        },
        plotOptions: {
            bar: {
                horizontal: true,
                barHeight: '70%',
                borderRadius: 4,
                distributed: false 
            }
        },
        colors: ['#C6FF00'],
        dataLabels: {
            enabled: true,
            textAnchor: 'middle',
            style: { colors: ['#000'], fontSize: '16px', fontWeight: 900 },
            formatter: function (val, opt) {
                return val
            },
            offsetX: 0,
        },
        xaxis: {
            categories: ['Москва', 'Санкт-Петербург', 'Казань', 'Самара', 'Нижний Новгород', 'Екатеринбург', 'Краснодар', 'Пермь', 'Ростов-на-Дону', 'Воронеж', 'Челябинск', 'Новосибирск', 'Уфа', 'Омск', 'Волгоград', 'Красноярск'],
            labels: { style: { colors: '#888', fontSize: '14px' } },
            axisBorder: { show: false },
            axisTicks: { show: false }
        },
        yaxis: {
            labels: { 
                style: { colors: '#fff', fontSize: '14px', fontFamily: 'Inter', fontWeight: 600 },
                maxWidth: 150
            }
        },
        grid: {
            borderColor: '#333',
            strokeDashArray: 4,
            xaxis: { lines: { show: true } },
            yaxis: { lines: { show: false } },
            padding: { right: 20, left: 10 }
        },
        legend: { show: false },
        tooltip: { theme: 'dark' }
    };
  
    // ==========================================
    // ИНИЦИАЛИЗАЦИЯ
    // ==========================================
    document.addEventListener('DOMContentLoaded', () => {
        // Рендерим Bar Chart
        if(document.querySelector("#chart-cities-pie")) {
            const chartCitiesBar = new ApexCharts(document.querySelector("#chart-cities-pie"), optionsCitiesBar);
            chartCitiesBar.render();
        }

        // 1. Инит статичных графиков
        if(document.querySelector("#chart-mean-check")) {
            new ApexCharts(document.querySelector("#chart-mean-check"), optionsMeanCheck).render();
        }
        if(document.querySelector("#chart-mean-traf")) {
            new ApexCharts(document.querySelector("#chart-mean-traf"), optionsMeanTraf).render();
        }
        if(document.querySelector("#chart-avg-check")) {
            chartAvgCheck = new ApexCharts(document.querySelector("#chart-avg-check"), optionsAvgCheck);
            chartAvgCheck.render();
        }
        if(document.querySelector("#chart-bar-settlements")) {
            chartSettlements = new ApexCharts(document.querySelector("#chart-bar-settlements"), optionsBarSettlements);
            chartSettlements.render();
        }
        if(document.querySelector("#chart-mini-revenue")) {
            chartMiniRevenue = new ApexCharts(document.querySelector("#chart-mini-revenue"), optionsBarSettlements);
            chartMiniRevenue.render();
        }
        if(document.querySelector("#chart-age-revenue")) {
        chartAgeRevenue = new ApexCharts(document.querySelector("#chart-age-revenue"), optionsAgeRevenue);
        chartAgeRevenue.render();
    }
        
        if(document.querySelector("#chart-heatmap")) {
            chartHeatmap = new ApexCharts(document.querySelector("#chart-heatmap"), optionsHeatmap);
            chartHeatmap.render();
        }


        if(document.querySelector("#chart-model-perf")) {
            chartModel = new ApexCharts(document.querySelector("#chart-model-perf"), optionsModelPerf);
            chartModel.render();
        }
        if(document.querySelector("#chart-robustness")) {
            chartRobustness = new ApexCharts(document.querySelector("#chart-robustness"), optionsRobustness);
            chartRobustness.render();
        }

        // ИНИЦИАЛИЗАЦИЯ ГРАФИКОВ 6 СЛАЙДА (РАСПРЕДЕЛЕНИЕ ПО ПЛОЩАДИ И ВОЗРАСТУ)
        if(document.querySelector("#chart-area-age")) {
            chartAreaAge = new ApexCharts(document.querySelector("#chart-area-age"), optionsAreaAge);
            chartAreaAge.render();
        }

        // НОВЫЕ ГРАФИКИ ДЛЯ 7 СЛАЙДА (МЕТРИКИ)
         if(document.querySelector("#chart-pyat-dist-new")) {
            const optionsPyatDistNew = {
                ...optionsDistStatic,
                plotOptions: { 
                    bar: { 
                        borderRadius: 2, 
                        borderRadiusApplication: 'end',
                        columnWidth: '70%',
                        dataLabels: { position: 'top' } 
                    } 
                },
                // Данные из Python (миллионники)
                series: [{ name: 'Кол-во магазинов', data: [1332, 1510, 1085, 622, 316, 110, 39, 14, 3] }],
                xaxis: { 
                    categories: ['0', '1', '2', '3', '4', '5', '6', '7', '8'],
                    title: { text: 'Кол-во Пятерочек рядом', style: { color: '#666', fontSize: '17px' } },
                    labels: { style: { colors: '#888', fontSize: '15px' } }
                },
                yaxis: { 
                    min: 0,
                    labels: { style: { colors: '#888', fontSize: '15px' }, formatter: (val) => val }
                },
                tooltip: { 
                    theme: 'dark', 
                    y: { formatter: (val) => val + " шт." } 
                },
                colors: [ACCENT_COLOR]
            };
            new ApexCharts(document.querySelector("#chart-pyat-dist-new"), optionsPyatDistNew).render();
        }

        if(document.querySelector("#chart-shops-dist-new")) {
            const optionsShopsDistNew = {
                ...optionsDistStatic,
                plotOptions: { 
                    bar: { 
                        borderRadius: 2, 
                        borderRadiusApplication: 'end',
                        columnWidth: '70%',
                        dataLabels: { position: 'top' } 
                    } 
                },
                // Данные из Python (миллионники)
                series: [{ name: 'Кол-во магазинов', data: [211, 313, 483, 595, 651, 605, 551, 513, 396, 280, 180, 96, 64, 54, 20, 9, 3, 3, 1, 3] }],
                xaxis: { 
                    categories: ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19'],
                    title: { text: 'Кол-во Магазинов рядом', style: { color: '#666', fontSize: '17px' } },
                    labels: { style: { colors: '#888', fontSize: '15px' } }
                },
                yaxis: { 
                    min: 0,
                    labels: { style: { colors: '#888', fontSize: '15px' }, formatter: (val) => val }
                },
                tooltip: { 
                    theme: 'dark', 
                    y: { formatter: (val) => val + " шт." } 
                },
                colors: ['#ffffff'] 
            };
            new ApexCharts(document.querySelector("#chart-shops-dist-new"), optionsShopsDistNew).render();
        }


        // SCATTER chart (chartScatter) больше не инициализируется, так как заменен на картинку

        // 2. Загрузка данных для Scatter (Слайд 3) удалена

        // 3. Загрузка данных для Гистограмм (Слайд 6 и 9)
        if (typeof Papa !== 'undefined') {
            Papa.parse("histplot.csv", {
                download: true,
                header: true,
                skipEmptyLines: true,
                complete: function(results) {
                    console.log("Hist CSV Loaded");
                    const revenueData = results.data.map(row => row['выручка']); 
                    const histData = createHistogramData(revenueData);
                  
                    if(chartSettlements) {
                        chartSettlements.updateOptions({
                            xaxis: { categories: histData.categories },
                            series: [{ name: 'Магазинов', data: histData.data }]
                        });
                    }
                    if(chartMiniRevenue) {
                        chartMiniRevenue.updateOptions({
                            xaxis: { 
                                categories: histData.categories, 
                                labels: { 
                                    show: true, rotate: -45, style: { colors: '#888', fontSize: '14px' }
                                } 
                            }, 
                            yaxis: { show: false }, 
                            grid: { padding: { left: 10, right: 10, bottom: 25 } },
                            series: [{ name: 'Магазинов', data: histData.data }]
                        });
                    }
                }
            });
        }

        // Инициализация T-test графиков
        if(document.querySelector("#chart-ttest")) {
            chartTtest = new ApexCharts(document.querySelector("#chart-ttest"), optionsTtest);
            chartTtest.render();
        }
      
        if(document.querySelector("#chart-ttest2")) {
            chartTtest2 = new ApexCharts(document.querySelector("#chart-ttest2"), optionsTtest2);
            chartTtest2.render();
        }

// НОВЫЙ ГРАФИК ДЛЯ 06 СЛАЙДА: ВЫРУЧКА ПО ПЛОЩАДИ (BOXPLOT)
        if(document.querySelector("#chart-area-rev-box")) {
            const optionsAreaRevBox = {
                series: [
                    {
                        type: 'boxPlot',
                        data: [
                            { x: 'Новые', y: [5.13, 38.19, 53.48, 74.56, 129.12] },
                            { x: 'Средние', y: [7.58, 44.11, 61.08, 85.63, 147.89] },
                            { x: 'Старые', y: [16.56, 70.86, 110.65, 151.44, 272.31] }
                        ]
                    }
                ],
                chart: {
                    type: 'boxPlot',
                    height: '100%',
                    background: 'transparent',
                    toolbar: { show: false },
                    animations: { enabled: true }
                },
                colors: [ACCENT_COLOR, '#ffffff'], 
                
                stroke: {
                    colors: ['#ffffff'],
                    width: 2
                },

                plotOptions: {
                    boxPlot: {
                        colors: {
                            upper: '#C6FF00', 
                            lower: '#A4D600'  
                        }
                    }
                },
                xaxis: {
                    type: 'category',
                    labels: {
                        style: { colors: '#888', fontSize: '16px', fontWeight: 600, fontFamily: 'Inter, sans-serif' }
                    }
                },
                yaxis: {
                    title: {
                        text: 'Средняя выручка за месяц',
                        // ИСПРАВЛЕНО: Отрицательное значение отодвигает заголовок влево от цифр
                        offsetX: -15, 
                        style: {
                            color: '#888',
                            fontSize: '18px',
                            fontWeight: 'bold',
                            fontFamily: 'Inter, sans-serif'
                        }
                    },
                    labels: { 
                        style: { colors: '#fff', fontSize: '16px', fontFamily: 'Inter, sans-serif' },
                        formatter: (val) => val.toFixed(0) + "M"
                    }
                },
                grid: { 
                    // ИСПРАВЛЕНО: Увеличиваем отступ слева, чтобы заголовок влез
                    padding: { left: 35 }, 
                    borderColor: '#333', 
                    strokeDashArray: 4 
                },
                tooltip: { theme: 'dark' }
            };
            new ApexCharts(document.querySelector("#chart-area-rev-box"), optionsAreaRevBox).render();
        }
        // АВТОМАТИЧЕСКОЕ ОПРЕДЕЛЕНИЕ ОБЩЕГО ЧИСЛА СЛАЙДОВ
        totalSlidesEl.innerText = 20;
        showSlide(currentSlide);
    });

    // ==========================================
    // CASINO LOGIC (FULL)
    // ==========================================
    
    // Код казино перенесен в js/game_casino.js

    // ==========================================
    // ЛОГИКА СЛАЙДЕРА
    // ==========================================
    // Восстанавливаем сохраненный слайд или начинаем с 0
    let savedSlide = localStorage.getItem('dano_current_slide');
    let currentSlide = savedSlide ? parseInt(savedSlide) : 0;

    const slides = document.querySelectorAll('.slide');
    const totalSlidesEl = document.getElementById('totalSlide');
    const currSlideEl = document.getElementById('currSlide');
    const slideCounter = document.querySelector('.slide-counter');

    function updateCounter() {
        let num = currentSlide + 1;
        currSlideEl.innerText = num < 10 ? '0' + num : num;
    }

    function showSlide(index) {
        if (index < 0) index = 0;
        if (index >= slides.length) index = slides.length - 1;
      
        currentSlide = index;
        localStorage.setItem('dano_current_slide', currentSlide);

        // Показываем счетчик на всех слайдах кроме титульника (0) и финальных (на ваше усмотрение)
        // Если хотите скрыть на последнем, используйте: if (index === 0 || index >= slides.length - 1)
        if (index === 0 || index >= 19) slideCounter.style.display = 'none';
        else slideCounter.style.display = '';

        slides.forEach((slide, i) => {
            slide.classList.remove('active');
            if (i === index) {
                slide.classList.add('active');
                slide.scrollTop = 0;
            }
        });
        updateCounter();
        triggerChartAnimations(index);
    }

    function triggerChartAnimations(index) {
        const slidesArr = Array.from(document.querySelectorAll('.slide'));
        const currentSlideEl = slidesArr[index];
      
        // Обновляем анимации по ID слайда, чтобы не зависеть от порядка
        // chartScatter удален из списка обновлений
        if (currentSlideEl.id === 'chartSlideDist') {
            if (chartAreaAge) chartAreaAge.updateOptions({ chart: { animations: { enabled: true } } });
        }
        if (currentSlideEl.id === 'chartSlide1') {
            if (chartSettlements) chartSettlements.updateOptions({ chart: { animations: { enabled: true } } });
            if (chartAvgCheck) chartAvgCheck.updateOptions({ chart: { animations: { enabled: true } } });
        }
        if (currentSlideEl.id === 'chartSlideAge') {
            if (chartAgeRevenue) chartAgeRevenue.updateOptions({ chart: { animations: { enabled: true } } });
        }
        if (currentSlideEl.id === 'chartSlideAge' && chartAgeRevenue) {
        chartAgeRevenue.updateOptions({ chart: { animations: { enabled: true } } });
    }
        if (currentSlideEl.id === 'chartSlide3') {
            if (chartTtest) chartTtest.updateOptions({ chart: { animations: { enabled: true } } });
            if (chartTtest2) chartTtest2.updateOptions({ chart: { animations: { enabled: true } } });
        }
        if (currentSlideEl.id === 'chartSlide4' && chartRobustness) {
            chartRobustness.updateOptions({ chart: { animations: { enabled: true } } });
        }
        // Для мини графика на слайде с метриками
        if (currentSlideEl.id === 'slide-metrics' && chartMiniRevenue) {
            chartMiniRevenue.updateOptions({ chart: { animations: { enabled: true } } });
        }
    }

    function nextSlide() {
        currentSlide = (currentSlide + 1) % slides.length;
        showSlide(currentSlide);
    }

    function prevSlide() {
        currentSlide = (currentSlide - 1 + slides.length) % slides.length;
        showSlide(currentSlide);
    }

    document.addEventListener('keydown', (e) => {
        const activeSlide = document.querySelector('.slide.active');
        if (e.code === 'Space') {
            e.preventDefault();
            if (activeSlide && activeSlide.id === 'teamSlide') {
                playCasino();
            } else {
                nextSlide();
            }
        } else if (e.key === 'ArrowRight') {
            nextSlide();
        } else if (e.key === 'ArrowLeft') {
            prevSlide();
        }
    });

    const teamPhotos = document.querySelectorAll('.team-photo-box');
    const explosionOverlay = document.getElementById('resurrection-explosion');
    if (teamPhotos.length > 0 && explosionOverlay) {
        teamPhotos.forEach(photo => {
            photo.addEventListener('mouseenter', () => {
                if (photo.id === 'offlane-photo') return;
                if (!photo.classList.contains('dead') && !photo.classList.contains('resurrected')) {
                    photo.classList.add('dead');
                } else if (photo.classList.contains('dead')) {
                    triggerResurrection(photo);
                }
            });
        });
    }

    function triggerResurrection(element) {
        explosionOverlay.classList.add('explode-anim');
        setTimeout(() => {
            element.classList.remove('dead');
            element.classList.add('resurrected');
        }, 400);
        setTimeout(() => {
            explosionOverlay.classList.remove('explode-anim');
        }, 800);
    }

    // Функция переключения режимов игры
    function switchGameMode(modeName, btnElement) {
        // 1. Скрываем все игровые блоки
        document.querySelectorAll('.game-mode').forEach(el => {
            el.style.display = 'none';
            el.classList.remove('active');
        });

        // 2. Убираем активный класс у кнопок
        document.querySelectorAll('.game-select-btn').forEach(btn => {
            btn.classList.remove('active');
        });

        // 3. Показываем нужный блок
        const target = document.getElementById(`mode-${modeName}`);
        if(target) {
            target.style.display = 'block';
            // Небольшой таймаут для анимации fade-in, если нужно
            setTimeout(() => target.classList.add('active'), 10);
        }

        // 4. Подсвечиваем нажатую кнопку
        if(btnElement) {
            btnElement.classList.add('active');
        }

        // Здесь можно вызывать функции инициализации игр, если они требуют рестарта
        // if (modeName === 'birds') initBirds();
        if (modeName === 'zombies') initZombies();
        else stopZombies();
    }
</script>

    <!-- Логика игр -->
    <script src="js/game_casino.js"></script>
    <script src="js/game_birds.js"></script>
    <script src="js/game_zombies.js"></script>
</body>
</html>