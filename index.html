<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <!-- Иконка вкладки -->
    <link rel="icon" href="images/Team_Spirit_new_em.svg" type="image/svg+xml">
    <title>Team Spirit | DANO Solution</title>
    
    <!-- Подключаем CSS стиля Toxic -->
    <link rel="stylesheet" href="style-spirit.css">
    
    <!-- Подключаем библиотеку для графиков -->
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>

</head>
<body>

    <!-- ВОДЯНОЙ ЗНАК -->
    <div class="watermark-container">
        <div class="watermark-text">TEAM SPIRIT</div>
        <img src="images/Team_Spirit_new_em.svg" alt="TS Logo" class="logo-watermark-img" style="filter: brightness(0) invert(1);">
    </div>

    <!-- СЧЕТЧИК СЛАЙДОВ -->
    <div class="slide-counter">
        <span id="currSlide" style="color: var(--accent);">01</span> / <span id="totalSlide">54</span>
    </div>

    <!-- ================= СЛАЙДЫ ================= -->

    <!-- 01. ТИТУЛЬНИК -->
    <div class="slide active flex-center">
        <div>
            <div style="display: flex; justify-content: center; align-items: center; gap: 30px; margin-bottom: 40px;">
                <img src="images/Team_Spirit_new_em.svg" alt="TS Logo" style="filter: brightness(0) invert(1); width: 180px; drop-shadow: 0 0 15px rgba(198, 255, 0, 0.2);">
                <span style="font-size: 3rem; font-weight: 900; color: var(--accent); text-shadow: 0 0 10px var(--accent);">X</span>
                <img src="images/X5_Tech.svg" alt="X5 Tech Logo" style="filter: brightness(0) invert(1); width: 300px; drop-shadow: 0 0 15px rgba(198, 255, 0, 0.2);">
            </div>
            
            <p style="letter-spacing: 4px; color: var(--accent); margin-bottom: 15px; font-weight: 700; text-shadow: 0 0 10px rgba(198, 255, 0, 0.4);">DANO OLYMPIAD 2025</p>
            <h1>Любовь одна а Data 2</h1>
            <div style="width: 80px; height: 6px; background: var(--accent); margin: 25px auto; box-shadow: 0 0 10px var(--accent);"></div>
            <p>Команда: Тим Спирит (филиал Таганрог)</p>
            <br>
            <div style="display: flex; justify-content: center; gap: 10px; flex-wrap: wrap;">
                <span class="tag">#DOTA_SCIENCE</span>
                <span class="tag">#ANALYTICS</span>
                <span class="tag">#TEAM_SPIRIT</span>
            </div>
        </div>
    </div>

   <!-- 02. СТРУКТУРА ДАТАСЕТА -->
    <div class="slide">
        <h2>02. Структура данных</h2>
        <!-- 1. Задали фиксированную высоту сетке (70vh) и убрали align-items: start -->
        <div style="display: grid; grid-template-columns: 1.2fr 0.8fr; gap: 30px; height: 70vh;">
            
            <!-- ЛЕВАЯ КОЛОНКА -->
            <div style="display: flex; flex-direction: column; gap: 20px; height: 100%;">
                
                <!-- Верхняя карточка -->
                <div class="card" style="display: flex; flex-direction: row; justify-content: space-between; align-items: center; border: 2px solid var(--accent); background: rgba(198, 255, 0, 0.05); padding: 20px;">
                    <div>
                        <h3 style="margin: 0; font-size: 1.4rem;">Данные о магазинах</h3>
                        <p style="margin: 5px 0 0 0; font-size: 1rem; opacity: 0.8;">Торговой сети</p>
                    </div>
                </div>

                <!-- Средние карточки (статистика) -->
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="card">
                        <div class="big-stat">256k</div>
                        <div class="stat-label">Строк данных</div>
                    </div>
                    <div class="card">
                        <div class="big-stat">21k</div>
                        <div class="stat-label">Магазина</div>
                    </div>
                </div>

                <!-- Нижняя карточка (Период) -> добавили flex: 1, чтобы она растянулась до низа -->
                <div class="card" style="text-align: center; flex: 1; display: flex; flex-direction: column; justify-content: center;">
                    <h3>Период данных</h3>
                    <div class="big-stat" style="font-size: 4rem; margin: 10px 0;">2024</div>
                    <p>Информация по каждому месяцу</p>
                </div>
            </div>

            <!-- ПРАВАЯ КОЛОНКА -->
            <div style="display: flex; flex-direction: column; gap: 20px; height: 100%;">
                <!-- Добавили flex: 1 обеим карточкам, чтобы они равномерно заполнили высоту -->
                <div class="card" style="flex: 1; display: flex; flex-direction: column; justify-content: center;">
                    <h3>Числовые признаки</h3>
                    <ul style="list-style: none; padding: 0; margin-top: 15px; font-size: 1.1rem;">
                        <li style="margin-bottom: 12px;">• Средний чек</li>
                        <li style="margin-bottom: 12px;">• Трафик</li>
                        <li style="margin-bottom: 12px;">• Инфраструктура</li>
                        <li>• Население</li>
                    </ul>
                </div>
                
                <div class="card" style="flex: 1; display: flex; flex-direction: column; justify-content: center;">
                    <h3>Категориальные признаки</h3>
                    <ul style="list-style: none; padding: 0; margin-top: 15px; font-size: 1.1rem;">
                        <li style="margin-bottom: 12px;">• Площадь</li>
                        <li style="margin-bottom: 12px;">• Дата открытия</li>
                        <li style="margin-bottom: 12px;">• Населенный пункт</li>
                        <li>• Месяц (порядковая)</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- 03. SCATTER PLOT (ОБНОВЛЕННЫЙ СЛАЙД - КАРТИНКА) -->
    <div class="slide" id="chartSlideScatter">
        <h2>03. ВВОД ПЕРЕМЕННОЙ: ВЫРУЧКА</h2>
        
        <!-- 1. Задали общую высоту 70vh для выравнивания низа -->
        <div style="display: grid; grid-template-columns: 1fr 300px; gap: 30px; height: 70vh;">
            
            <!-- Левая часть: Картинка графика -->
            <!-- 2. Добавили height: 100%, чтобы карточка занимала всю высоту ячейки -->
            <div class="card" style="padding: 0px; overflow: hidden; display: flex; flex-direction: column; justify-content: center; align-items: center; background: #000; height: 100%;">
                <div class="chart-container-fix" style="width: 100%; height: 100%; display: flex; justify-content: center; align-items: center;">
                    <img src="images/grahs.jpg" alt="График зависимости" style="max-width: 100%; max-height: 100%; object-fit: contain; border-radius: 4px;">
                </div>
            </div>

            <!-- Правая часть: Описание -->
            <!-- 3. Добавили height: 100%, чтобы контейнер колонки был во всю высоту -->
            <div style="display: flex; flex-direction: column; gap: 20px; height: 100%;">
                
                <div class="card">
                    <h3 style="color: var(--accent);">Предпосылка</h3>
                    <p>Почти каждый посетитель совершает покупку.</p>
                </div>
                
                <!-- 4. Добавили flex: 1, чтобы эта карточка растянулась и заполнила пустоту -->
                <div class="card" style="border: 2px solid var(--accent); background: rgba(198, 255, 0, 0.05); flex: 1; display: flex; flex-direction: column; justify-content: center;">
                    <h3>ФОРМУЛА</h3>
                    <div style="font-size: 1.4rem; font-weight: 900; margin: 15px 0;">
                        ВЫРУЧКА = <br>
                        <span style="color: var(--accent);">ТРАФИК</span> &times; ЧЕК
                    </div>
                    <p style="font-size: 0.8rem; opacity: 0.7;">
                        Обе переменные модифицированы составителями датасета.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- 04. КОРРЕЛЯЦИИ (БЫВШИЙ 8 СЛАЙД) -->
    <div class="slide" id="chartSlide2">
        <h2>04. КОРРЕЛЯЦИИ</h2>
        <div class="card" style="height: 70vh; padding: 10px; overflow: hidden;">
            <div class="chart-container-fix">
                 <div id="chart-heatmap" style="width: 100%; height: 100%;"></div>
            </div>
        </div>
    </div>

    <!-- 05. РАСПРЕДЕЛЕНИЕ (СТАТИЧНЫЕ ДАННЫЕ) -->
    <div class="slide" id="chartSlideDist">
        <h2>05. ВЛИЯНИЕ ОКРУЖЕНИЯ</h2>
        
        <div style="display: grid; grid-template-rows: 1fr auto; gap: 20px; height: 75vh;">
            
            <!-- Блок с графиками -->
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; min-height: 0;">
                
                <!-- График 1: Пятерочки -->
                <div class="card" style="padding: 15px; display: flex; flex-direction: column;">
                    <h3 style="text-align: center; font-size: 1rem; color: #fff; margin-bottom: 10px;">
                        ПО КОЛИЧЕСТВУ <span style="color: var(--accent);">ПЯТЕРОЧЕК</span> РЯДОМ
                    </h3>
                    <div class="chart-container-fix" style="flex: 1;">
                        <div id="chart-pyat-dist" style="width: 100%; height: 100%;"></div>
                    </div>
                </div>

                <!-- График 2: Магазины -->
                <div class="card" style="padding: 15px; display: flex; flex-direction: column;">
                    <h3 style="text-align: center; font-size: 1rem; color: #fff; margin-bottom: 10px;">
                        ПО КОЛИЧЕСТВУ <span style="color: #aaa;">МАГАЗИНОВ</span> РЯДОМ
                    </h3>
                    <div class="chart-container-fix" style="flex: 1;">
                        <div id="chart-shops-dist" style="width: 100%; height: 100%;"></div>
                    </div>
                </div>
            </div>

            <!-- Блок с выводом -->
            <div class="card" style="padding: 20px; border-left: 6px solid var(--accent); background: rgba(198, 255, 0, 0.05); display: flex; flex-direction: column; justify-content: center;">
                <h3 style="color: var(--accent); margin-bottom: 10px; text-transform: uppercase;">ВЫВОД</h3>
                <p style="font-size: 1.1rem; margin-bottom: 5px; font-weight: bold;">
                   Пятерочек, у которых нет обычных магазинов рядом, крайне мало.
                </p>
                <p style="font-size: 0.9rem; color: #ccc; margin-top: 5px;">
                   Исследовать влияние полного отсутствия конкуренции бессмысленно (выборка мала). <br>
                   К тому же, "обычные магазины" могут быть любого размера, что вносит шум в данные.
                </p>
            </div>
        </div>
    </div>

    <!-- 06. НОВЫЕ ПЕРЕМЕННЫЕ: МЕТРИКИ (БЫВШИЙ 5 СЛАЙД) -->
    <div class="slide" id="slide-metrics">
        <h2>06. ВВОД НОВОЙ БИНАРНОЙ ПЕРЕМЕННОЙ «НАЛИЧИЕ ПЯТЕРОЧЕК»</h2>
        
        <div style="display: grid; grid-template-columns: 1.5fr 1fr; gap: 30px; height: 70vh;">
            
            <!-- Left Column: 2 Charts -->
            <div style="display: flex; flex-direction: column; gap: 20px;">
                <div class="card" style="flex: 1; display: flex; flex-direction: column; overflow: hidden;">
                    <h4 style="margin-bottom: 5px; text-align: center;">Распределение по кол-ву пятерочек</h4>
                    <div class="chart-container-fix" style="flex: 1;">
                        <div id="chart-pyat-dist-new" style="width: 100%; height: 100%;"></div>
                    </div>
                </div>
                <div class="card" style="flex: 1; display: flex; flex-direction: column; overflow: hidden;">
                    <h4 style="margin-bottom: 5px; text-align: center;">Распределение по кол-ву магазинов</h4>
                    <div class="chart-container-fix" style="flex: 1;">
                        <div id="chart-shops-dist-new" style="width: 100%; height: 100%;"></div>
                    </div>
                </div>
            </div>

            <!-- Right Column: Explanation + Binary Stats -->
            <div style="display: flex; flex-direction: column; gap: 20px;">
                <div class="card" style="padding: 20px;">
                    <h3 style="color: var(--accent); margin-bottom: 10px;">Почему бинарная?</h3>
                    <p>
                        Графики показывают, что магазинов с > 2 пятерочками рядом очень мало.
                        <br>
                        Поэтому переходим к бинарной переменной.
                    </p>
                </div>

                 <div class="card" style="padding: 20px; flex: 1; display: flex; flex-direction: column; justify-content: center;">
                    <h3 style="margin-bottom: 20px; text-align: center;">Новая переменная: «наличие_пятерочек»</h3>
                    
                    <div style="display: flex; flex-direction: column; gap: 30px;">
                        <!-- 0: Без Пятерочек -->
                        <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 8px; border-left: 4px solid #888;">
                            <div style="font-size: 1rem; color: #aaa; margin-bottom: 5px;">Без Пятерочек</div>
                            <div style="font-size: 2.2rem; font-weight: 900; color: #fff;">121 509</div>
                            <div style="font-size: 0.9rem; color: #666;">~47%</div>
                        </div>

                        <!-- 1: С Пятерочками -->
                        <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 8px; border-left: 4px solid var(--accent);">
                            <div style="font-size: 1rem; color: #aaa; margin-bottom: 5px;">С Пятерочками</div>
                            <div style="font-size: 2.2rem; font-weight: 900; color: #fff;">134 982</div>
                            <div style="font-size: 0.9rem; color: #666;">~53%</div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
    

    <!-- 07. ИССЛЕДОВАТЕЛЬСКИЙ ВОПРОС (БЫВШИЙ 6 СЛАЙД) -->
    <div class="slide">
        <h2>07. ИССЛЕДОВАТЕЛЬСКИЙ ВОПРОС</h2>
        <div class="card flex-center" style="flex: 1;">
            <h1 style="font-size: 2.5rem; text-align: center;">
                Как соседство с <span style="color: #ea1f41;">пятерочками</span> влияет на <span style="color: var(--accent);">выручку</span>?
            </h1>
        </div>
    </div>

    <!-- 08. ОБРАБОТКА ДАННЫХ -->
    <div class="slide">
        <h2>08. ОБРАБОТКА ДАННЫХ</h2>
        
        <div style="display: grid; grid-template-columns: 1fr 2.5fr; gap: 30px; height: 70vh;">
            
            <!-- ЛЕВАЯ КОЛОНКА: Пропуски и Удаленные по дате -->
            <div style="display: flex; flex-direction: column; gap: 20px;">
                <!-- Пропуски -->
                <div class="card" style="padding: 20px; flex: 0.6; display: flex; flex-direction: column; justify-content: center; border-left: 6px solid var(--accent); background: rgba(198, 255, 0, 0.05);">
                    <h3 style="color: var(--accent); margin-bottom: 5px; font-size: 1.2rem;">ПРОПУСКИ</h3>
                    <div style="text-align: center;">
                        <span style="font-size: 4rem; font-weight: 900; color: #fff; line-height: 1; text-shadow: 0 0 20px rgba(255,255,255,0.3);">0</span>
                        <div style="font-weight: 700; color: var(--accent); font-size: 0.9rem;">ПУСТЫХ ЗНАЧЕНИЙ</div>
                    </div>
                </div>

                <!-- Удалено по дате -->
                <div class="card" style="padding: 20px; flex: 1.4; border-left: 6px solid #ff5555; background: rgba(255, 85, 85, 0.05); display: flex; flex-direction: column; justify-content: center;">
                    <h3 style="color: #ff5555; margin-bottom: 15px; font-size: 1.1rem;">УДАЛЕНО ПО ДАТЕ</h3>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <!-- Мегановый -->
                        <div style="background: rgba(0,0,0,0.2); padding: 10px; border-radius: 8px; text-align: center;">
                            <div style="font-size: 1.8rem; font-weight: bold; color: #fff;">176</div>
                            <div style="font-size: 0.75rem; color: #ccc;">Мегановый</div>
                        </div>
                        <!-- Новый -->
                        <div style="background: rgba(0,0,0,0.2); padding: 10px; border-radius: 8px; text-align: center;">
                            <div style="font-size: 1.8rem; font-weight: bold; color: #fff;">43</div>
                            <div style="font-size: 0.75rem; color: #ccc;">Новый</div>
                        </div>
                        <!-- Средний -->
                        <div style="background: rgba(0,0,0,0.2); padding: 10px; border-radius: 8px; text-align: center;">
                            <div style="font-size: 1.8rem; font-weight: bold; color: #fff;">7</div>
                            <div style="font-size: 0.75rem; color: #ccc;">Средний</div>
                        </div>
                        <!-- Давно -->
                        <div style="background: rgba(0,0,0,0.2); padding: 10px; border-radius: 8px; text-align: center;">
                            <div style="font-size: 1.8rem; font-weight: bold; color: #fff;">6</div>
                            <div style="font-size: 0.75rem; color: #ccc;">Давно</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ПРАВАЯ КОЛОНКА: Выбросы -->
            <div class="card" style="padding: 30px; border-left: 6px solid #ff5555; background: rgba(255, 85, 85, 0.05); display: flex; flex-direction: column;">
                
                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 25px; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 15px;">
                    <div style="display: flex; align-items: center; gap: 15px;">
                        <div style="background: #ff5555; color: #fff; width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 900; font-size: 1.2rem;">!</div>
                        <h3 style="color: #ff5555; margin: 0; font-size: 1.5rem;">ОЧИСТКА ВЫБРОСОВ</h3>
                    </div>
                    <div style="text-align: right;">
                        <span style="font-size: 0.9rem; color: #888;">Метод:</span>
                        <span style="font-weight: bold; color: #fff;">IQR (Межквартильный размах)</span>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 40px; height: 100%;">
                    
                    <!-- Логика очистки (Текст) -->
                    <div style="display: flex; flex-direction: column; gap: 25px; justify-content: flex-start;">
                        
                        <!-- Блок 1: Простые проверки -->
                        <div>
                            <div style="margin-bottom: 8px;">
                                <span class="tag" style="border-color: #555; color: #ccc;">Пятерочки</span>
                                <span style="color: #fff; font-weight: bold;">Выбросов нет.</span>
                            </div>
                            <div>
                                <!-- <span class="tag" style="border-color: var(--accent); color: var(--accent);">Выручка (Y)</span> -->
                                <!-- <span style="color: #fff;">Очищаем, так как это целевая переменная.</span> -->
                            </div>
                        </div>

                        <!-- Блок 2: Трафик -->
                        <div>
                            <strong style="color: var(--accent); font-size: 1.1rem; display: block; margin-bottom: 8px;">ТРАФИК</strong>
                            <p style="font-size: 0.9rem; color: #ccc; margin-bottom: 5px;">
                                Население сильно различается -> <span style="color: #fff;">Верхней границы нет.</span>
                            </p>
                            <p style="font-size: 0.9rem; color: #ccc;">
                                Удаляем только экстремально низкие значения:
                            </p>
                            <div class="code-block" style="margin: 10px 0; padding: 10px;">Lower = Q1 - <span style="color: var(--accent); font-weight: bold;">3</span> * IQR</div>
                        </div>

                        <!-- Блок 3: Средний чек -->
                        <div>
                            <strong style="color: var(--accent); font-size: 1.1rem; display: block; margin-bottom: 8px;">СРЕДНИЙ ЧЕК</strong>
                            <p style="font-size: 0.9rem; color: #ccc;">
                                Меньше зависит от населения. Удаляем строже:
                            </p>
                            <div class="code-block" style="margin: 10px 0; padding: 10px;">Lower = Q1 - <span style="color: var(--accent); font-weight: bold;">1.5</span> * IQR</div>
                        </div>
                    </div>

                    <!-- Результаты (Цифры) -->
                    <div style="display: flex; flex-direction: column; justify-content: center; gap: 20px; background: rgba(0,0,0,0.2); padding: 20px; border-radius: 10px;">
                        <h4 style="text-align: center; color: #888; text-transform: uppercase; letter-spacing: 2px;">Итого удалено</h4>
                        
                        <!-- Трафик -->
                        <div style="text-align: center;">
                            <div style="font-size: 3rem; font-weight: 900; color: #fff; line-height: 1;">59</div>
                            <div style="color: var(--accent); font-weight: 700; font-size: 0.9rem; margin-top: 5px;">ЗНАЧЕНИЙ ТРАФИКА</div>
                            <div style="font-size: 0.8rem; color: #666; margin-top: 2px;">(менее 1%)</div>
                        </div>

                        <div style="height: 1px; background: #444; width: 50%; margin: 0 auto;"></div>

                        <!-- Чек -->
                        <div style="text-align: center;">
                            <div style="font-size: 3rem; font-weight: 900; color: #fff; line-height: 1;">229</div>
                            <div style="color: var(--accent); font-weight: 700; font-size: 0.9rem; margin-top: 5px;">ЗНАЧЕНИЙ СР. ЧЕКА</div>
                            <div style="font-size: 0.8rem; color: #666; margin-top: 2px;">(менее 1%)</div>
                        </div>

                        <!-- <div style="margin-top: 10px; text-align: center; font-style: italic; color: #777; font-size: 0.85rem;">
                            Данные очищены и готовы к анализу
                        </div> -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 09. ВЫРУЧКА ПО ДАТАМ ОТКРЫТИЯ (ОБНОВЛЕННЫЙ) -->
    <div class="slide" id="chartSlideAge">
        <h2>09. ВЫРУЧКА ПО ДАТАМ ОТКРЫТИЯ</h2>
        
        <div style="display: grid; grid-template-columns: 3.5fr 1fr; gap: 30px; height: 70vh;">
            
            <!-- ГРАФИК -->
            <div class="card" style="padding: 20px; display: flex; flex-direction: column; overflow: hidden;">
                <!-- chart-container-fix гарантирует, что график займет всю высоту и ширину -->
                <div class="chart-container-fix" style="flex: 1; min-height: 0;">
                    <div id="chart-age-revenue" style="width: 100%; height: 100%;"></div>
                </div>
            </div>

            <!-- ЛЕГЕНДА И ИНСАЙТ -->
            <div style="display: flex; flex-direction: column; gap: 20px;">
                
                <!-- Легенда -->
                <div class="card" style="padding: 20px;">
                    <h3 style="margin-bottom: 15px; font-size: 1.1rem; color: #fff;">ЛЕГЕНДА</h3>
                    
                    <div style="display: flex; flex-direction: column; gap: 15px;">
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <div style="width: 24px; height: 24px; background: #C6FF00; border-radius: 4px; box-shadow: 0 0 10px rgba(198, 255, 0, 0.4);"></div>
                            <div>
                                <!-- <div style="font-weight: 900; font-size: 1.2rem; color: #fff;">0</div> -->
                                <div style="font-size: 0.75rem; color: #888;">НЕТ ПЯТЕРОЧЕК</div>
                            </div>
                        </div>

                        <div style="display: flex; align-items: center; gap: 10px;">
                            <div style="width: 24px; height: 24px; background: #ffffff; border-radius: 4px; border: 1px solid #999;"></div>
                             <div>
                                <!-- <div style="font-weight: 900; font-size: 1.2rem; color: #fff;">1</div> -->
                                <div style="font-size: 0.75rem; color: #888;">ЕСТЬ ПЯТЕРОЧКИ</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Статистика по датам -->
                <div class="card" style="padding: 15px; flex: 1; display: flex; flex-direction: column;">
                    <h3 style="margin-bottom: 10px; font-size: 1rem; color: #fff;">Количество строк по дате открытия магазина</h3>
                    <div style="overflow-x: auto;">
                        <table style="width: 100%; border-collapse: collapse; font-size: 0.85rem;">
                            <thead>
                                <tr style="border-bottom: 1px solid var(--accent);">
                                    <th style="text-align: left; padding: 8px; color: #aaa;">Дата открытия</th>
                                    <th style="text-align: right; padding: 8px; color: #aaa;">Кол-во</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr style="border-bottom: 1px solid #333;">
                                    <td style="padding: 8px;">Средниe по возрасту</td>
                                    <td style="text-align: right; padding: 8px; font-weight: bold; color: #fff;">161 020</td>
                                </tr>
                                <tr style="border-bottom: 1px solid #333;">
                                    <td style="padding: 8px;">Новыe</td>
                                    <td style="text-align: right; padding: 8px; font-weight: bold; color: #fff;">75 861</td>
                                </tr>
                                <tr style="border-bottom: 1px solid #333;">
                                    <td style="padding: 8px;">Открыты давно</td>
                                    <td style="text-align: right; padding: 8px; font-weight: bold; color: #fff;">10 978</td>
                                </tr>
                                <tr>
                                    <td style="padding: 8px;">Новейшие</td>
                                    <td style="text-align: right; padding: 8px; font-weight: bold; color: #fff;">8 632</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 10. ГИПОТЕЗА -->
    <div class="slide">
        <h2>10. ГИПОТЕЗА</h2>
        <div class="fill-height flex-center">
            <div class="card" style="padding: 50px; border: 2px solid var(--accent); text-align: center; max-width: 900px; background: rgba(198, 255, 0, 0.02);">
               <h1 style="font-size: 2.5rem; line-height: 1.4; text-transform: none; text-shadow: none;">
    Соседство с другими точками бьет по <span style="color: var(--accent);">выручке</span> старых пятёрочек <span style="color: var(--accent);">сильнее всего</span>
                </h1>
            </div>
        </div>
    </div>

    <!-- 11. МЕХАНИЗМ -->
    <div class="slide">
        <h2>11. МЕХАНИЗМ</h2>
        <div class="fill-height" style="display: flex; flex-direction: column; justify-content: center; gap: 15px;">
            <div class="card flex-center" style="padding: 20px; border-color: var(--accent);">
                <h3 style="color: var(--accent); margin: 0; font-size: 1.3rem;">СОВРЕМЕННОЕ ОБОРУДОВАНИЕ И ДИЗАЙН</h3>
            </div>
            <div style="text-align: center; color: var(--accent); font-size: 1.5rem; line-height: 1;">▼</div>
            <div class="card flex-center" style="padding: 15px; border: 1px dashed #555;">
                <p style="margin: 0; font-weight: bold; font-size: 1.1rem;">НОВЫЕ ПЯТЕРОЧКИ ПРИВЛЕКАТЕЛЬНЕЕ СТАРЫХ</p>
            </div>
            <div style="text-align: center; color: var(--accent); font-size: 1.5rem; line-height: 1;">▼</div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; width: 100%;">
                <div class="card" style="padding: 20px; background: rgba(198, 255, 0, 0.05);">
                    <div style="display: flex; align-items: baseline; gap: 10px; margin-bottom: 10px;">
                        <span style="font-size: 2.5rem; font-weight: 900; color: var(--accent); line-height: 1;">01</span>
                        <h4 style="margin: 0;">НОВЫЕ</h4>
                    </div>
                    <p style="font-size: 0.95rem;">Теряют меньше спроса от наличия старых магазинов рядом.</p>
                </div>
                <div class="card" style="padding: 20px; background: rgba(255, 85, 85, 0.05); border-color: #ff5555;">
                    <div style="display: flex; align-items: baseline; gap: 10px; margin-bottom: 10px;">
                        <span style="font-size: 2.5rem; font-weight: 900; color: #ff5555; line-height: 1;">02</span>
                        <h4 style="margin: 0;">СТАРЫЕ</h4>
                    </div>
                    <p style="font-size: 0.95rem;">Теряют больше спроса от наличия новых магазинов рядом.</p>
                </div>
            </div>
            <div style="text-align: center; color: var(--accent); font-size: 1.5rem; line-height: 1;">▼</div>
            <div class="card" style="padding: 20px; text-align: center; border: 2px solid var(--accent); background: rgba(198, 255, 0, 0.02);">
                <p style="font-size: 1.2rem; line-height: 1.4; font-weight: bold; margin: 0;">
                    Наличие пятерочёк рядом <span style="color: var(--accent);">значительнее</span> влияет на выручку <span style="color: #ff5555;">СТАРЫХ</span>, чем на выручку новых.
                </p>
            </div>
        </div>
    </div>

    <!-- 12. АЛЬТЕРНАТИВНЫЙ МЕХАНИЗМ -->
    <div class="slide">
        <h2>12. АЛЬТЕРНАТИВНЫЙ МЕХАНИЗМ</h2>
        <div class="fill-height" style="display: flex; flex-direction: column; justify-content: center; gap: 15px;">
            
            <!-- 1. Неполнота информации -->
            <div class="card flex-center" style="padding: 20px; border-color: var(--accent);">
                <div style="text-align: center;">
                    <h3 style="color: var(--accent); margin: 0; font-size: 1.3rem;">НЕПОЛНОТА ИНФОРМАЦИИ</h3>
                    <p style="margin: 5px 0 0 0; font-size: 0.9rem; color: #ccc;">Старые пятерочки открывались с меньшей информацией о местности.</p>
                </div>
            </div>

            <div style="text-align: center; color: var(--accent); font-size: 1.5rem; line-height: 1;">▼</div>

            <!-- 2. Оптимальная локация -->
            <div class="card flex-center" style="padding: 15px; border: 1px dashed #555;">
                <div style="text-align: center;">
                    <p style="margin: 0; font-weight: bold; font-size: 1.1rem;">ОПТИМАЛЬНАЯ ЛОКАЦИЯ</p>
                    <p style="margin: 5px 0 0 0; font-size: 0.9rem; color: #aaa;">Новые пятёрочки <span style="color: var(--accent);">оптимальнее</span> выбрали место.</p>
                </div>
            </div>

            <div style="text-align: center; color: var(--accent); font-size: 1.5rem; line-height: 1;">▼</div>

            <!-- 3. Следствие -->
            <div class="card" style="padding: 20px; text-align: center; border: 2px solid var(--accent); background: rgba(198, 255, 0, 0.02);">
                <p style="font-size: 1.2rem; line-height: 1.4; font-weight: bold; margin: 0;">
                    Рядом стоящие пятёрочки <span style="color: var(--accent);">значительнее</span> снижают выручку старого магазина.
                </p>
            </div>
        </div>
    </div>

    <!-- 13. МАТ МОДЕЛЬ (ОБНОВЛЕННЫЙ: 2 ГРАФИКА) -->
    <div class="slide" id="chartSlide3">
        <h2>13. МАТ-МОДЕЛЬ</h2>
        
        <div style="display: grid; grid-template-columns: 500px 1fr; gap: 30px; height: 75vh;">
            
            <!-- ЛЕВАЯ КОЛОНКА: СТАТИСТИКА И ТЕОРИЯ -->
            <div style="display: flex; flex-direction: column; gap: 20px;">
                
                <!-- Описание метода -->
                <div class="card" style="padding: 20px; border-left: 4px solid var(--accent);">
                    <h3 style="color: #fff; margin-bottom: 10px;">Методология</h3>
                    <p style="font-size: 0.95rem; color: #ccc; margin-bottom: 15px;">
                        Используется <strong>t-тест Уэлча</strong> (для независимых выборок с неравными дисперсиями).
                    </p>
                    
                    <div style="background: rgba(255,255,255,0.05); padding: 12px; border-radius: 6px; border: 1px solid #444;">
                        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 5px;">
                            <span style="font-size: 0.9rem; font-weight: bold; color: #fff;">Критерий Левена</span>
                        </div>
                        <p style="font-size: 0.85rem; margin: 0; color: #aaa;">
                            P-value < 0.05 <br>
                            <span style="color: var(--accent);">Дисперсии статистически не равны.</span>
                        </p>
                    </div>
                </div>

                <!-- Блок статистики (Численные) -->
                <div class="card" style="padding: 20px; flex: 1; display: flex; flex-direction: column; justify-content: center;">
                    <h3 style="margin-bottom: 15px; text-align: left;">Результаты (млн ₽)</h3>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div>
                            <div style="font-size: 0.85rem; color: #888; text-transform: uppercase; margin-bottom: 5px;">Разница (Старые)</div>
                            <div style="font-size: 1.8rem; color: #ff5555; font-weight: 900;">-16.9M</div>
                            <div style="color: #ff5555; font-size: 0.9rem;">(p < 0.01)</div>
                        </div>

                        <div>
                            <div style="font-size: 0.85rem; color: #888; text-transform: uppercase; margin-bottom: 5px;">Разница (остальные)</div>
                            <div style="font-size: 1.8rem; color: #fff; font-weight: 900;">-0.75M</div>
                            <div style="color: var(--accent); font-size: 0.9rem;">(p < 0.01)</div>
                        </div>
                    </div>
                </div>

                <!-- Блок статистики (Проценты) -->
                <div class="card" style="padding: 20px; flex: 1; display: flex; flex-direction: column; justify-content: center;">
                    <h3 style="margin-bottom: 15px; text-align: left;">Результаты (%)</h3>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div>
                            <div style="font-size: 0.85rem; color: #888; text-transform: uppercase; margin-bottom: 5px;">Разница (Старые)</div>
                            <div style="font-size: 1.8rem; color: #ff5555; font-weight: 900;">14.4%</div>
                        </div>

                        <div>
                            <div style="font-size: 0.85rem; color: #888; text-transform: uppercase; margin-bottom: 5px;">Разница (остальные)</div>
                            <div style="font-size: 1.8rem; color: #fff; font-weight: 900;">1.3%</div>
                        </div>
                    </div>
                </div>

            </div>

            <!-- ПРАВАЯ КОЛОНКА: 2 ГРАФИКА -->
            <div style="display: flex; flex-direction: column; gap: 20px; height: 100%;">
                
                <!-- ГРАФИК 1: Старые (Сильный эффект) -->
                <div class="card" style="flex: 1; padding: 15px; display: flex; flex-direction: column; overflow: hidden;">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <h4 style="margin: 0; color: var(--accent);">1. Выборка: Старые магазины</h4>
                        <span style="font-size: 0.8rem; color: #666;">Сильное влияние</span>
                    </div>
                    <div class="chart-container-fix" style="flex: 1; min-height: 0;">
                        <div id="chart-ttest" style="width: 100%; height: 100%;"></div>
                    </div>
                </div>

                <!-- ГРАФИК 2: Все (Слабый эффект) -->
                <div class="card" style="flex: 1; padding: 15px; display: flex; flex-direction: column; overflow: hidden;">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <h4 style="margin: 0; color: #fff;">2. Выборка: Остальные</h4>
                        <span style="font-size: 0.8rem; color: #666;">Слабое влияние</span>
                    </div>
                    <div class="chart-container-fix" style="flex: 1; min-height: 0;">
                        <div id="chart-ttest2" style="width: 100%; height: 100%;"></div>
                    </div>
                </div>

            </div>

        </div>
    </div>

    <!-- 14. УСТОЙЧИВОСТЬ -->
    <!-- 14. УСТОЙЧИВОСТЬ И НОВЫЕ ПЕРЕМЕННЫЕ (ОБЪЕДИНЕННЫЙ) -->
    <div class="slide" id="chartSlide4">
        <h2>14. ПРОВЕРКА НА УСТОЙЧИВОСТЬ</h2>
        
        <div style="display: grid; grid-template-columns: 1.8fr 1fr; gap: 30px; height: 75vh;">
            
            <!-- ЛЕВАЯ КОЛОНКА: ТАБЛИЦА -->
            <div class="card" style="padding: 20px; display: flex; flex-direction: column; gap: 20px;">
                
                <!-- ТАБЛИЦА 1 -->
                <div style="flex: 1; display: flex; flex-direction: column;">
                    <h3 style="margin-bottom: 10px;">По типам населенных пунктов</h3>
                    <div style="overflow-x: auto; flex: 1;">
                        <table style="width: 100%; border-collapse: collapse; font-size: 0.9rem; text-align: center;">
                            <thead>
                                <tr style="border-bottom: 2px solid var(--accent);">
                                    <th style="padding: 8px; text-align: left;">Тип НП</th>
                                    <th style="padding: 8px;">Разница (без 5-ок)</th>
                                    <th style="padding: 8px;">%</th>
                                    <th style="padding: 8px;">P-value</th>
                                    <th style="padding: 8px; border-left: 1px solid #555;">Разница (с 5-ками)</th>
                                    <th style="padding: 8px;">%</th>
                                    <th style="padding: 8px;">P-value</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr style="border-bottom: 1px solid #333;">
                                    <td style="padding: 8px; text-align: left; font-weight: bold; color: #fff;">Малые</td>
                                    <td>14.1 M</td>
                                    <td style="color: var(--accent);">13.9%</td>
                                    <td>0.00</td>
                                    <td style="border-left: 1px solid #555;">1.7 M</td>
                                    <td style="color: var(--accent);">2.9%</td>
                                    <td>0.00</td>
                                </tr>
                                <tr style="border-bottom: 1px solid #333;">
                                    <td style="padding: 8px; text-align: left; font-weight: bold; color: #fff;">Средние</td>
                                    <td>12.7 M</td>
                                    <td style="color: var(--accent);">11.5%</td>
                                    <td>0.00</td>
                                    <td style="border-left: 1px solid #555;">-0.9 M</td>
                                    <td style="color: #ff4560;">-1.9%</td>
                                    <td>0.00</td>
                                </tr>
                                <tr style="border-bottom: 1px solid #333;">
                                    <td style="padding: 8px; text-align: left; font-weight: bold; color: #fff;">Большие</td>
                                    <td>-4.5 M</td>
                                    <td style="color: #ff4560;">-5.3%</td>
                                    <td style="color: #ff4560;">0.15</td>
                                    <td style="border-left: 1px solid #555;">-0.2 M</td>
                                    <td style="color: #ff4560;">-0.4%</td>
                                    <td style="color: #ff4560;">0.53</td>
                                </tr>
                                <tr style="border-bottom: 1px solid #333;">
                                    <td style="padding: 8px; text-align: left; font-weight: bold; color: #fff;">Крупные</td>
                                    <td>11.8 M</td>
                                    <td style="color: var(--accent);">12.6%</td>
                                    <td>0.00</td>
                                    <td style="border-left: 1px solid #555;">3.1 M</td>
                                    <td style="color: var(--accent);">5.3%</td>
                                    <td>0.00</td>
                                </tr>
                                <tr style="border-bottom: 1px solid #333;">
                                    <td style="padding: 8px; text-align: left; font-weight: bold; color: #fff;">Крупнейшие</td>
                                    <td>28.6 M</td>
                                    <td style="color: var(--accent);">27.5%</td>
                                    <td>0.00</td>
                                    <td style="border-left: 1px solid #555;">3.6 M</td>
                                    <td style="color: var(--accent);">6.8%</td>
                                    <td>0.00</td>
                                </tr>
                                <tr>
                                    <td style="padding: 8px; text-align: left; font-weight: bold; color: #fff;">Миллионники</td>
                                    <td>23.9 M</td>
                                    <td style="color: var(--accent);">18.0%</td>
                                    <td>0.00</td>
                                    <td style="border-left: 1px solid #555;">6.0 M</td>
                                    <td style="color: var(--accent);">8.6%</td>
                                    <td>0.00</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- ТАБЛИЦА 2 -->
                <div style="flex: 0.8; display: flex; flex-direction: column; border-top: 1px solid #333; padding-top: 15px;">
                    <div style="display: flex; justify-content: space-between; align-items: baseline; margin-bottom: 10px;">
                        <h3 style="margin: 0;">По дате открытия пятерочки</h3>
                    </div>
                    <div style="overflow-x: auto; flex: 1;">
                        <table style="width: 100%; border-collapse: collapse; font-size: 0.9rem; text-align: center;">
                            <thead>
                                <tr style="border-bottom: 2px solid var(--accent);">
                                    <th style="padding: 8px; text-align: left;">Группа</th>
                                    <th style="padding: 8px;">Разница средних</th>
                                    <th style="padding: 8px;">Проценты</th>
                                    <th style="padding: 8px;">P-value</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr style="border-bottom: 1px solid #333;">
                                    <td style="padding: 8px; text-align: left; font-weight: bold; color: #fff;">Новейшие</td>
                                    <td>5.0 M</td>
                                    <td style="color: var(--accent);">11.80%</td>
                                    <td>0.00</td>
                                </tr>
                                <tr style="border-bottom: 1px solid #333;">
                                    <td style="padding: 8px; text-align: left; font-weight: bold; color: #fff;">Новые</td>
                                    <td>1.4 M</td>
                                    <td style="color: var(--accent);">2.41%</td>
                                    <td>0.00</td>
                                </tr>
                                <tr style="border-bottom: 1px solid #333;">
                                    <td style="padding: 8px; text-align: left; font-weight: bold; color: #fff;">Средние по возрасту</td>
                                    <td>0.4 M</td>
                                    <td style="color: var(--accent);">0.73%</td>
                                    <td>0.00</td>
                                </tr>
                                <tr>
                                    <td style="padding: 8px; text-align: left; font-weight: bold; color: #fff;">Открыты давно</td>
                                    <td>16.9 M</td>
                                    <td style="color: var(--accent);">14.38%</td>
                                    <td>0.00</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- ПРАВАЯ КОЛОНКА: ОБЪЯСНЕНИЯ ПЕРЕМЕННЫХ -->
            <div style="display: flex; flex-direction: column; gap: 20px;">
                
                <!-- 1. Классификация (Легенда к таблице) -->
                <div class="card" style="padding: 20px; flex: 1; display: flex; flex-direction: column;">
                    <h3 style="color: #fff; margin-bottom: 15px; font-size: 1.1rem;">Классификация</h3>
                    <div style="display: flex; flex-direction: column; gap: 10px; flex: 1; justify-content: space-evenly;">
                        <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 4px; display: flex; align-items: center; justify-content: space-between;">
                            <div style="color: #fff; font-weight: bold; font-size: 1rem;">МАЛЫЙ</div>
                            <div style="font-size: 0.9rem; color: #888;">0-50 тыс.</div>
                        </div>
                        <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 4px; display: flex; align-items: center; justify-content: space-between;">
                            <div style="color: #fff; font-weight: bold; font-size: 1rem;">СРЕДНИЙ</div>
                            <div style="font-size: 0.9rem; color: #888;">50-100 тыс.</div>
                        </div>
                        <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 4px; display: flex; align-items: center; justify-content: space-between;">
                            <div style="color: #fff; font-weight: bold; font-size: 1rem;">БОЛЬШОЙ</div>
                            <div style="font-size: 0.9rem; color: #888;">100-250 тыс.</div>
                        </div>
                        <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 4px; display: flex; align-items: center; justify-content: space-between;">
                            <div style="color: #fff; font-weight: bold; font-size: 1rem;">КРУПНЫЙ</div>
                            <div style="font-size: 0.9rem; color: #888;">250-500 тыс.</div>
                        </div>
                        <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 4px; display: flex; align-items: center; justify-content: space-between;">
                            <div style="color: #fff; font-weight: bold; font-size: 1rem;">КРУПНЕЙШИЙ</div>
                            <div style="font-size: 0.9rem; color: #888;">0.5 - 1 млн</div>
                        </div>
                        <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 4px; display: flex; align-items: center; justify-content: space-between;">
                            <div style="color: #fff; font-weight: bold; font-size: 1rem;">МИЛЛИОННИК</div>
                            <div style="font-size: 0.9rem; color: #888;">> 1 млн</div>
                        </div>
                    </div>
                    <div style="margin-top: 15px; font-size: 0.8rem; color: #666; font-style: italic; text-align: center;">
                        * Классификация по Т.В. Малеевой («Инженерно-экономические основы градостроительства»)
                    </div>
                </div>

            </div>
        </div>
    </div>
    <!-- 15. Гипотеза подтвердилась -->
    <div class="slide">
        <h2>15. Гипотеза подтвердилась</h2>
        <div class="card" style="padding: 40px; height: 60vh; display: flex; flex-direction: column; justify-content: center;">
            <h3 style="color: var(--accent); margin-bottom: 30px; font-size: 2.5rem;">Проверка на устойчивость</h3>
            <p style="font-size: 2.0rem; margin-bottom: 30px; line-height: 1.4;">
                Почти для всех населенных пунктов подтвердилось, кроме больших. Это можно объяснить:
            </p>
            <ul style="list-style: none; padding: 0; font-size: 2.0rem; line-height: 1.4;">
                <li style="margin-bottom: 20px; padding-left: 25px; border-left: 5px solid var(--accent);">
                    Не самый высокий спрос и относительно большое число магазинов <br>
                    <span style="color: var(--accent); font-weight: bold;">=></span> жёсткая конкуренция, а потому эффект новизны заглушается на данных.
                </li>
            </ul>
        </div>
    </div>

    <!-- 16. ОГРАНИЧЕНИЯ -->
    <div class="slide">
        <h2>16. ОГРАНИЧЕНИЯ И ПЕРСПЕКТИВЫ</h2>
        <div class="grid-2">
            <div class="card">
                <h3>ОГРАНИЧЕНИЯ</h3>
                <ul style="font-size: 1.3rem;">
                    <li><strong>Короткий период:</strong> Данные за 1 год скрывают долгосрочные тренды.</li>
                    <li><strong>Слепые зоны:</strong> Нет данных о конкурентах в радиусах 200–500 м.</li>
                    <li><strong>Детали точек:</strong> Нет сведений об оборудовании и дизайне.</li>
                    <li><strong>Геолокация:</strong> Отсутствие координат снижает точность моделей.</li>
                </ul>
            </div>
            <div class="card">
                <h3>ПЕРСПЕКТИВЫ</h3>
                <ul style="font-size: 1.3rem;">
                    <li><strong>Срок эффекта:</strong> Найти момент ослабевания «эффекта новой Пятёрочки».</li>
                    <li><strong>Радиус влияния:</strong> Оценить дистанцию воздействия на рынок.</li>
                    <li><strong>Драйверы:</strong> Определить элементы формата, усиливающие эффект.</li>
                    <li><strong>Гео-анализ:</strong> Повысить качество пространственных расчетов.</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- 17. ПОЛИСИ -->
    <div class="slide">
        <h2>17. ПОЛИСИ</h2>
        <div class="grid-2">
            <div class="card">
                <h3>БИЗНЕС-РЕШЕНИЕ</h3>
                <p>Корректировать план открытий в малых городах с учетом плотности конкурентов.</p>
            </div>
            <div class="card" style="border: 1px solid var(--accent);">
                <h3>ЭФФЕКТ</h3>
                <p class="big-stat" style="color: var(--accent);">+$50M</p>
                <p>Potential Revenue Uplift</p>
            </div>
        </div>
    </div>

    <!-- 18. КОМАНДА -->
    <div class="slide">
        <h2>18. КОМАНДА</h2>
        <div class="fill-height" style="justify-content: center;">
            <div style="display: flex; justify-content: center; gap: 20px; width: 100%;">
                <div class="card" style="padding: 10px; flex: 1;">
                    <div class="team-photo-box" style="background-image: url('images/photo_2025-12-09_11-27-21.jpg');"></div>
                    <div style="padding: 10px;"><h3>CARRY</h3></div>
                </div>
                <div class="card" style="padding: 10px; flex: 1;">
                    <div class="team-photo-box" style="background-image: url('images/db112ad479a169c8f5f1465418636ee5.1000x1000x1.png');"></div>
                    <div style="padding: 10px;"><h3>MID</h3></div>
                </div>
                 <div class="card" style="padding: 10px; flex: 1;">
                    <div class="team-photo-box dead" style="background-image: url('images/tete.jpg');"></div>
                    <div style="padding: 10px;"><h3>SUPPORT</h3></div>
                </div>
                <div class="card" style="padding: 10px; flex: 1;">
                    <div class="team-photo-box" style="background-image: url('images/photo_2025-12-09_11-27-57.jpg');"></div>
                    <div style="padding: 10px;"><h3>HARD SUPPORT</h3></div>
                    
                </div>
            </div>
        </div>
    </div>

    <!-- ФИНАЛ -->
    <div class="slide flex-center">
        <img src="images/pudge.png" style="position: absolute; top: 0; left: 30%; width: 70%; height: 100%; object-fit: cover; opacity: 0.25; z-index: 0; pointer-events: none;" alt="Pudge">
        <div style="position: relative; z-index: 1;">
            <h1 style="font-size: 4.5rem;">GG WP</h1>
            <p style="color: var(--accent);">THANKS FOR WATCHING</p>
            <div style="margin-top: 40px;">
                <img src="images/Team_Spirit_new_em.svg" alt="TS Logo" style="filter: brightness(0) invert(1); width: 150px; opacity: 0.6;">
            </div>
        </div>
    </div>

    <div id="resurrection-explosion"></div>
    
    <!-- ================= CONTROLS & JS ================= -->
    <div class="controls">
        <div class="btn-group">
            <button class="btn" onclick="prevSlide()"> &#8249; </button>
            <button class="btn" onclick="nextSlide()"> &#8250; </button>
        </div>
    </div>

    <script>
    // ==========================================
    // ГЛОБАЛЬНЫЕ ПЕРЕМЕННЫЕ ДЛЯ ГРАФИКОВ
    // ==========================================
    let chartSettlements, chartHeatmap, chartRobustness;
    let chartAvgCheck, chartMiniRevenue, chartAgeRevenue;
    let chartPyatDist, chartShopsDist;
    // Переменная chartScatter удалена, так как заменена на картинку

    const ACCENT_COLOR = '#C6FF00'; 
    const TEXT_COLOR = '#ffffff';

    // Общие настройки графиков
    const commonOptions = {
        chart: {
            background: 'transparent',
            toolbar: { show: false },
            animations: { enabled: true, easing: 'easeinout', speed: 800 },
            fontFamily: 'Inter, sans-serif',
        },
        theme: { mode: 'dark' },
        colors: [ACCENT_COLOR, '#444444'],
        grid: { borderColor: '#333', strokeDashArray: 4 },
        dataLabels: { enabled: false },
        stroke: { curve: 'smooth', width: 3 },
    };

    // СЛАЙД 9: СРЕДНИЙ ЧЕК
    const optionsAvgCheck = {
        ...commonOptions,
        series: [{
            name: 'Средний чек',
            data: [1319, 969, 937, 776]
        }],
        chart: { 
            type: 'bar', 
            height: '100%', 
            background: 'transparent', 
            toolbar: { show: false }, 
            animations: { enabled: true } 
        },
        grid: {
            padding: { bottom: 10, left: 10, right: 20 }
        },
        plotOptions: { 
            bar: { 
                borderRadius: 4, 
                horizontal: true, 
                barHeight: '60%',
                distributed: true 
            } 
        },
        colors: [ACCENT_COLOR, '#aeea00', '#96d000', '#7cb300'],
        xaxis: { 
            categories: ['Открыт давно', 'Средний возраст', 'Недавно открытый', 'Новый'], 
            labels: { 
                style: { colors: '#888', fontSize: '12px' },
            },
            axisBorder: { show: false },
            axisTicks: { show: false }
        },
        yaxis: {
            labels: { 
                style: { colors: '#ffffff', fontSize: '14px', fontWeight: 'bold' },
                maxWidth: 200
            }
        },
        tooltip: { theme: 'dark', y: { formatter: (val) => val + " ₽" } },
        legend: { show: false }
    };

    // ГИСТОГРАММА (БИННИНГ)
    function createHistogramData(dataArray) {
        const nums = dataArray.map(v => parseFloat(v)).filter(v => !isNaN(v));
        if (nums.length === 0) return { categories: [], data: [] };

        const minVal = Math.min(...nums);
        const maxVal = Math.max(...nums);
        const step = 3000000; 

        const start = Math.floor(minVal / step) * step;
        const end = Math.ceil(maxVal / step) * step;

        const categories = [];
        const binsCount = Math.round((end - start) / step) + 1;
        const bins = new Array(binsCount).fill(0);

        for (let i = 0; i < binsCount; i++) {
            const currentVal = start + (i * step);
            const label = new Intl.NumberFormat('en-US', { 
                notation: "compact", 
                compactDisplay: "short",
                maximumFractionDigits: 1 
            }).format(currentVal);
            categories.push(label);
        }

        nums.forEach(num => {
            let bucketIndex = Math.floor((num - start) / step);
            if (bucketIndex < 0) bucketIndex = 0;
            if (bucketIndex >= binsCount) bucketIndex = binsCount - 1;
            bins[bucketIndex]++;
        });

        return { categories, data: bins };
    }

    // СЛАЙД 9: ГИСТОГРАММА (Заготовка)
    const optionsBarSettlements = {
        ...commonOptions,
        series: [{ name: 'Магазинов', data: [] }],
        chart: { type: 'bar', height: '100%', background: 'transparent', toolbar: { show: false }, animations: { enabled: true } },
        plotOptions: { bar: { borderRadius: 0, horizontal: false, columnWidth: '100%' } },
        grid: { borderColor: '#333', strokeDashArray: 4, padding: { bottom: 30, left: 10, right: 10 } },
        xaxis: { 
            categories: [], 
            title: { text: 'Выручка', offsetY: -5, style: { color: '#ffffff', fontSize: '18px', fontWeight: 'bold' } },
            labels: { 
                show: true, rotate: -45, style: { colors: '#888', fontSize: '14px' },
                formatter: function(val, timestamp, opts) {
                    if (opts && typeof opts.i !== 'undefined') {
                        if (opts.i % 8 === 0) return val; 
                        return ''; 
                    }
                    return val;
                }
            }, 
            axisBorder: { show: false }, axisTicks: { show: false } 
        },
        yaxis: {
            min: 0,
            title: { text: 'Количество', style: { color: '#ffffff', fontSize: '18px', fontWeight: 'bold' } },
            labels: { style: { colors: '#888', fontSize: '14px' } }
        },
        colors: [ACCENT_COLOR],
        tooltip: { theme: 'dark', y: { formatter: (val) => val + " шт." } }
    };

    // СЛАЙД 4: HEATMAP (КОРРЕЛЯЦИИ)
    const optionsHeatmap = {
        ...commonOptions,
        series: [
            { name: 'e-commerce',      data: [1.00, 0.23, 0.11, 0.22, 0.23, 0.17, 0.22] },
            { name: 'медучреждения',   data: [0.23, 1.00, 0.22, 0.37, 0.43, 0.34, 0.15] },
            { name: 'школы',           data: [0.11, 0.22, 1.00, 0.19, 0.24, 0.20, 0.08] },
            { name: 'остановки',       data: [0.22, 0.37, 0.19, 1.00, 0.27, 0.26, 0.20] },
            { name: 'магазины',        data: [0.23, 0.43, 0.24, 0.27, 1.00, 0.72, -0.01] },
            { name: 'пятерочки',       data: [0.17, 0.34, 0.20, 0.26, 0.72, 1.00, -0.02] },
            { name: 'выручка',         data: [0.22, 0.15, 0.08, 0.20, -0.01, -0.02, 1.00] }
        ],
        chart: { type: 'heatmap', height: '100%', background: 'transparent', toolbar: { show: false } },
        legend: {
            show: true, position: 'right', offsetY: 0, width: 60,
            itemMargin: { vertical: 0, horizontal: 0 },
            markers: { width: 20, height: 25, radius: 0 },
            fontSize: '15px', labels: { colors: '#888' }
        },
        plotOptions: { 
            heatmap: { 
                shadeIntensity: 0.5, radius: 2, useFillColorAsStroke: false,
                colorScale: { 
                    ranges: [
                        { from: -1.0, to: 0.0, color: '#560319', name: '< 0' },
                        { from: 0.01, to: 0.15, color: '#FF2300', name: '0.1' },
                        { from: 0.16, to: 0.30, color: '#FF6F00', name: '0.2' },
                        { from: 0.31, to: 0.45, color: '#FFBA00', name: '0.4' },
                        { from: 0.46, to: 0.60, color: '#E6FF00', name: '0.6' },
                        { from: 0.61, to: 0.80, color: '#9bd100', name: '0.8' },
                        { from: 0.81, to: 1.00, color: '#8fb900', name: '1.0' }
                    ] 
                } 
            } 
        },
        dataLabels: { enabled: true, style: { colors: ['#fff'], fontSize: '14px', fontWeight: 'bold' } },
        xaxis: { 
            categories: ['e-commerce', 'медучреждения', 'школы', 'остановки', 'магазины', 'пятерочки', 'выручка'],
            labels: { style: { colors: '#ffffff', fontSize: '14px', fontWeight: 'bold' } }, tooltip: { enabled: false }
        },
        yaxis: { reversed: true, labels: { style: { colors: '#ffffff', fontSize: '14px', fontWeight: 'bold' } } },
        stroke: { width: 1, colors: ['#000'] }
    };

    // ==========================================
    // СЛАЙД 13: T-TEST Charts
    // ==========================================
    let chartTtest, chartTtest2;

    // Общие настройки стиля для T-test графиков
    const ttestCommonOptions = {
        chart: {
            type: 'boxPlot',
            height: '100%',
            background: 'transparent',
            toolbar: { show: false },
            animations: { enabled: true }
        },
        colors: ['#008FFB', '#FF4560'],
        plotOptions: {
            boxPlot: {
                colors: { upper: '#008FFB', lower: '#008FFB' }
            }
        },
        stroke: {
            colors: ['#ccc'],
            width: 1 // Уменьшили толщину линий
        },
        grid: {
            borderColor: '#333',
            strokeDashArray: 4,
            yaxis: { lines: { show: true } },
            padding: { top: 0, bottom: 0 }
        },
        markers: {
            size: 8, // Увеличили размер точек
            strokeWidth: 0,
            hover: { size: 10 }
        },
        legend: { show: false },
        tooltip: {
            theme: 'dark',
            shared: true,
            intersect: false
        }
    };

    // ГРАФИК 1: СТАРЫЕ МАГАЗИНЫ (Данные из предыдущей версии)
    const optionsTtest = {
        ...ttestCommonOptions,
        series: [
            {
                name: 'Доверительный интервал (95%)',
                type: 'boxPlot',
                data: [
                    { x: 'Без Пятерочек', y: [115.27, 117.37, 117.37, 117.37, 119.46] },
                    { x: 'С Пятерочками', y: [99.37, 100.49, 100.49, 100.49, 101.60] }
                ]
            },
            {
                name: 'Среднее значение',
                type: 'scatter',
                data: [
                    { x: 'Без Пятерочек', y: 117.37 },
                    { x: 'С Пятерочками', y: 100.49 }
                ]
            }
        ],
        xaxis: {
            categories: ['Без Пятерочек', 'С Пятерочками'],
            labels: {
                style: { colors: '#fff', fontSize: '12px', fontWeight: 'bold' } // Мелкий шрифт
            },
            tooltip: { enabled: false }
        },
        yaxis: {
            labels: {
                style: { colors: '#888', fontSize: '12px' },
                formatter: (val) => val.toFixed(0) + "M"
            },
            min: 90, 
            max: 130
        },
        tooltip: {
            theme: 'dark',
            y: { formatter: (val) => val + " млн ₽" }
        }
    };

    // ГРАФИК 2: ОБЩАЯ ВЫБОРКА (Новые данные)
    // Данные: Без=58.11 (CI: 57.94-58.28), С=57.36 (CI: 57.19-57.52)
    const optionsTtest2 = {
        ...ttestCommonOptions,
        series: [
            {
                name: 'Доверительный интервал (95%)',
                type: 'boxPlot',
                data: [
                    { 
                        x: 'Без Пятерочек', 
                        y: [57.94, 58.11, 58.11, 58.11, 58.28] // Min, Q1, Med, Q3, Max
                    },
                    { 
                        x: 'С Пятерочками', 
                        y: [57.19, 57.36, 57.36, 57.36, 57.52] 
                    }
                ]
            },
            {
                name: 'Среднее значение',
                type: 'scatter',
                data: [
                    { x: 'Без Пятерочек', y: 58.11 },
                    { x: 'С Пятерочками', y: 57.36 }
                ]
            }
        ],
        xaxis: {
            categories: ['Без Пятерочек', 'С Пятерочками'],
            labels: {
                style: { colors: '#fff', fontSize: '12px', fontWeight: 'bold' } // Мелкий шрифт
            },
            tooltip: { enabled: false }
        },
        yaxis: {
            labels: {
                style: { colors: '#888', fontSize: '12px' },
                formatter: (val) => val.toFixed(1) + "M"
            },
            // Задаем узкий диапазон, чтобы было видно разницу
            min: 56.5, 
            max: 59.0,
            tickAmount: 5
        },
        tooltip: {
            theme: 'dark',
            y: { formatter: (val) => val.toFixed(2) + " млн ₽" }
        }
    };

    // --- ВСТАВИТЬ ЭТО В document.addEventListener('DOMContentLoaded', ...) ---
    
    // Инициализация (вместо chartModel)
    if(document.querySelector("#chart-ttest")) {
        chartTtest = new ApexCharts(document.querySelector("#chart-ttest"), optionsTtest);
        chartTtest.render();
    }


    // СЛАЙД 14: УСТОЙЧИВОСТЬ
    const optionsRobustness = {
        ...commonOptions,
        series: [{ name: 'Train', data: [0.85, 0.84, 0.86] }, { name: 'Test', data: [0.83, 0.82, 0.84] }, { name: 'OOT', data: [0.81, 0.80, 0.82] }],
        chart: { type: 'bar', height: '100%', background: 'transparent', toolbar: { show: false } },
        plotOptions: { bar: { borderRadius: 2, horizontal: false, columnWidth: '50%' } },
        xaxis: { categories: ['Fold 1', 'Fold 2', 'Fold 3'] },
        colors: ['#555555', '#888888', ACCENT_COLOR]
    };

    // ==========================================
    // ДАННЫЕ ДЛЯ 5 СЛАЙДА (СНЯТЫ СО СКРИНШОТОВ)
    // ==========================================
    // Данные по выручке (примерно 1e7) в зависимости от кол-ва пятерочек (0-9)
    const dataPyatRevenue = [5.95, 6.1, 6.15, 5.8, 5.6, 5.0, 5.3, 4.0, 4.7, 2.9]; 
    const catsPyat = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9'];

    // Данные по выручке (примерно 1e7) в зависимости от кол-ва магазинов (0-19)
    const dataShopRevenue = [
        5.7, 5.95, 6.0, 6.1, 6.2, 6.15, 6.18, 6.0, 5.95, 5.6, 
        5.7, 5.5, 5.1, 5.6, 4.8, 5.1, 3.5, 4.5, 5.5, 6.2
    ];
    const catsShop = Array.from({length: 20}, (_, i) => i.toString());

    // Настройки для графиков 5 слайда
    const optionsDistStatic = {
        ...commonOptions,
        chart: { type: 'bar', height: '100%', background: 'transparent', toolbar: { show: false }, animations: { enabled: true } },
        plotOptions: { 
            bar: { 
                borderRadius: 4, 
                columnWidth: '70%',
                dataLabels: { position: 'top' } // убрали цифры сверху для чистоты
            } 
        },
        dataLabels: { enabled: false },
        yaxis: { 
            title: { text: 'Выручка (x10 млн)', style: { color: '#888', fontSize: '16px' } },
            labels: { style: { colors: '#888', fontSize: '14px' }, formatter: (val) => val.toFixed(1) }
        },
        colors: [ACCENT_COLOR],
        tooltip: { 
            theme: 'dark', 
            y: { formatter: (val) => (val * 10).toFixed(1) + " млн ₽" } 
        }
    };
// СЛАЙД 9: НАСТРОЙКИ ГРАФИКА
    const optionsAgeRevenue = {
        ...commonOptions, // Наследуем общие стили (темная тема, шрифты)
        series: [
            {
                name: 'Нет Пятерочек (0)',
                data: [42296150, 56971440, 59587900, 117370800] 
                // Порядок данных соответствует категориям в xaxis
            },
            {
                name: 'Есть Пятерочки (1)',
                data: [37306900, 55598870, 59154170, 100491000]
            }
        ],
        chart: {
            type: 'bar',
            height: '100%',
            background: 'transparent',
            toolbar: { show: false },
            animations: { enabled: true, speed: 1000 }
        },
        plotOptions: {
            bar: {
                horizontal: true,       // Горизонтальный, как просили
                dataLabels: { position: 'top' }, // Цифры сбоку от бара
                barHeight: '70%',
                borderRadius: 2
            }
        },
        // ЦВЕТА: Акцентный (Зеленый) и Белый
        colors: ['#C6FF00', '#ffffff'], 
        
        dataLabels: {
            enabled: true,
            textAnchor: 'start',
            offsetX: 30, // Отступ цифр от бара (увеличил, чтобы не наезжало)
            style: { 
                colors: ['#fff'], 
                fontSize: '14px', 
                fontFamily: 'Inter, sans-serif',
                fontWeight: 700 
            },
            formatter: function (val) {
                // Превращаем 117370800 в "117.4M" для экономии места
                return (val / 1000000).toFixed(1) + "M";
            }
        },
        stroke: { 
            show: true, 
            width: 1, 
            colors: ['#000'] // Черная обводка для контраста
        },
        
        xaxis: {
            max: 140000000,
            // Порядок категорий снизу вверх или сверху вниз (ApexCharts рисует снизу вверх по массиву)
            categories: ['Новейшие', 'Новые', 'Средние по возрасту', 'Открыты давно'],
            labels: {
                style: { colors: '#888', fontSize: '12px' },
                formatter: (val) => (val / 1000000).toFixed(0) + "M"
            },
            axisBorder: { show: false },
            axisTicks: { show: false }
        },
        yaxis: {
            labels: {
                style: { 
                    colors: '#ffffff', 
                    fontSize: '13px', 
                    fontWeight: 'bold',
                    fontFamily: 'Monument Extended, sans-serif' // Акцентный шрифт для категорий
                },
                maxWidth: 200 // !ВАЖНО: Даем место под длинные названия ("Средние по возрасту")
            }
        },
        grid: {
            padding: { right: 100, left: 10 }, // Еще больше места справа под цифры
            borderColor: '#333',
            strokeDashArray: 4
        },
        tooltip: {
            theme: 'dark',
            y: { formatter: (val) => new Intl.NumberFormat('ru-RU').format(val) + " ₽" }
        },
        legend: { show: false } // Легенду мы сверстали в HTML отдельно
    };
    
    // ==========================================
    // ИНИЦИАЛИЗАЦИЯ
    // ==========================================
    document.addEventListener('DOMContentLoaded', () => {
        // 1. Инит статичных графиков
        if(document.querySelector("#chart-avg-check")) {
            chartAvgCheck = new ApexCharts(document.querySelector("#chart-avg-check"), optionsAvgCheck);
            chartAvgCheck.render();
        }
        if(document.querySelector("#chart-bar-settlements")) {
            chartSettlements = new ApexCharts(document.querySelector("#chart-bar-settlements"), optionsBarSettlements);
            chartSettlements.render();
        }
        if(document.querySelector("#chart-mini-revenue")) {
            chartMiniRevenue = new ApexCharts(document.querySelector("#chart-mini-revenue"), optionsBarSettlements);
            chartMiniRevenue.render();
        }
        if(document.querySelector("#chart-age-revenue")) {
        chartAgeRevenue = new ApexCharts(document.querySelector("#chart-age-revenue"), optionsAgeRevenue);
        chartAgeRevenue.render();
    }
        if(document.querySelector("#chart-heatmap")) {
            chartHeatmap = new ApexCharts(document.querySelector("#chart-heatmap"), optionsHeatmap);
            chartHeatmap.render();
        }
        if(document.querySelector("#chart-model-perf")) {
            chartModel = new ApexCharts(document.querySelector("#chart-model-perf"), optionsModelPerf);
            chartModel.render();
        }
        if(document.querySelector("#chart-robustness")) {
            chartRobustness = new ApexCharts(document.querySelector("#chart-robustness"), optionsRobustness);
            chartRobustness.render();
        }

        // ИНИЦИАЛИЗАЦИЯ ГРАФИКОВ 5 СЛАЙДА (СТАТИКА)
        if(document.querySelector("#chart-pyat-dist")) {
            chartPyatDist = new ApexCharts(document.querySelector("#chart-pyat-dist"), {
                ...optionsDistStatic,
                series: [{ name: 'Выручка', data: dataPyatRevenue }],
                xaxis: { 
                    categories: catsPyat, 
                    title: { text: 'Кол-во Пятерочек', style: { color: '#666', fontSize: '16px' } },
                    labels: { style: { colors: '#888', fontSize: '14px' } }
                }
            });
            chartPyatDist.render();
        }

        // НОВЫЕ ГРАФИКИ ДЛЯ 6 СЛАЙДА (МЕТРИКИ)
        if(document.querySelector("#chart-pyat-dist-new")) {
            const optionsPyatDistNew = {
                ...optionsDistStatic,
                plotOptions: { 
                    bar: { 
                        borderRadius: 2, 
                        borderRadiusApplication: 'end', // Fix for small values sinking
                        columnWidth: '70%',
                        dataLabels: { position: 'top' } 
                    } 
                },
                series: [{ name: 'Кол-во магазинов', data: [10319, 5998, 3157, 1441, 566, 187, 49, 20, 4, 1] }],
                xaxis: { 
                    categories: ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9'],
                    title: { text: 'Кол-во Пятерочек рядом', style: { color: '#666', fontSize: '14px' } },
                    labels: { style: { colors: '#888', fontSize: '12px' } }
                },
                // === ИСПРАВЛЕНИЕ: ПЕРЕОПРЕДЕЛЯЕМ ФОРМАТ (ШТУКИ ВМЕСТО ВАЛЮТЫ) ===
                yaxis: { 
                    min: 0,
                    labels: { style: { colors: '#888', fontSize: '12px' }, formatter: (val) => val }
                },
                tooltip: { 
                    theme: 'dark', 
                    y: { formatter: (val) => val + " шт." } 
                },
                colors: [ACCENT_COLOR]
            };
            new ApexCharts(document.querySelector("#chart-pyat-dist-new"), optionsPyatDistNew).render();
        }

        if(document.querySelector("#chart-shops-dist-new")) {
            const optionsShopsDistNew = {
                ...optionsDistStatic,
                plotOptions: { 
                    bar: { 
                        borderRadius: 2, 
                        borderRadiusApplication: 'end', // Fix for small values sinking
                        columnWidth: '70%',
                        dataLabels: { position: 'top' } 
                    } 
                },
                series: [{ name: 'Кол-во магазинов', data: [2780, 3138, 2839, 2619, 2348, 2083, 1706, 1375, 992, 759, 451, 278, 170, 110, 55, 23, 8, 4, 1, 3] }],
                xaxis: { 
                    categories: ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19'],
                    title: { text: 'Кол-во Магазинов рядом', style: { color: '#666', fontSize: '14px' } },
                    labels: { style: { colors: '#888', fontSize: '12px' } }
                },
                // === ИСПРАВЛЕНИЕ: ПЕРЕОПРЕДЕЛЯЕМ ФОРМАТ (ШТУКИ ВМЕСТО ВАЛЮТЫ) ===
                yaxis: { 
                    min: 0,
                    labels: { style: { colors: '#888', fontSize: '12px' }, formatter: (val) => val }
                },
                tooltip: { 
                    theme: 'dark', 
                    y: { formatter: (val) => val + " шт." } 
                },
                colors: ['#ffffff'] 
            };
            new ApexCharts(document.querySelector("#chart-shops-dist-new"), optionsShopsDistNew).render();
        }

        if(document.querySelector("#chart-shops-dist")) {
            chartShopsDist = new ApexCharts(document.querySelector("#chart-shops-dist"), {
                ...optionsDistStatic,
                series: [{ name: 'Выручка', data: dataShopRevenue }],
                xaxis: { 
                    categories: catsShop,
                    title: { text: 'Кол-во Магазинов', style: { color: '#666', fontSize: '16px' } },
                    labels: { style: { colors: '#888', fontSize: '14px' } }
                }
            });
            chartShopsDist.render();
        }
        // SCATTER chart (chartScatter) больше не инициализируется, так как заменен на картинку

        // 2. Загрузка данных для Scatter (Слайд 3) удалена

        // 3. Загрузка данных для Гистограмм (Слайд 6 и 9)
        if (typeof Papa !== 'undefined') {
            Papa.parse("histplot.csv", {
                download: true,
                header: true,
                skipEmptyLines: true,
                complete: function(results) {
                    console.log("Hist CSV Loaded");
                    const revenueData = results.data.map(row => row['выручка']); 
                    const histData = createHistogramData(revenueData);
                    
                    if(chartSettlements) {
                        chartSettlements.updateOptions({
                            xaxis: { categories: histData.categories },
                            series: [{ name: 'Магазинов', data: histData.data }]
                        });
                    }
                    if(chartMiniRevenue) {
                        chartMiniRevenue.updateOptions({
                            xaxis: { 
                                categories: histData.categories, 
                                labels: { 
                                    show: true, rotate: -45, style: { colors: '#888', fontSize: '14px' }
                                } 
                            }, 
                            yaxis: { show: false }, 
                            grid: { padding: { left: 10, right: 10, bottom: 25 } },
                            series: [{ name: 'Магазинов', data: histData.data }]
                        });
                    }
                }
            });
        }

        // Инициализация T-test графиков
        if(document.querySelector("#chart-ttest")) {
            chartTtest = new ApexCharts(document.querySelector("#chart-ttest"), optionsTtest);
            chartTtest.render();
        }
        
        if(document.querySelector("#chart-ttest2")) {
            chartTtest2 = new ApexCharts(document.querySelector("#chart-ttest2"), optionsTtest2);
            chartTtest2.render();
        }

        totalSlidesEl.innerText = slides.length;
        showSlide(currentSlide);
    });

    // ==========================================
    // ЛОГИКА СЛАЙДЕРА
    // ==========================================
    let currentSlide = 0;
    const slides = document.querySelectorAll('.slide');
    const totalSlidesEl = document.getElementById('totalSlide');
    const currSlideEl = document.getElementById('currSlide');
    const slideCounter = document.querySelector('.slide-counter');

    function updateCounter() {
        let num = currentSlide + 1;
        currSlideEl.innerText = num < 10 ? '0' + num : num;
    }

    function showSlide(index) {
        if (index === 0) slideCounter.style.display = 'none';
        else slideCounter.style.display = '';

        slides.forEach((slide, i) => {
            slide.classList.remove('active');
            if (i === index) {
                slide.classList.add('active');
                slide.scrollTop = 0;
            }
        });
        updateCounter();
        triggerChartAnimations(index);
    }

    function triggerChartAnimations(index) {
        const slidesArr = Array.from(document.querySelectorAll('.slide'));
        const currentSlideEl = slidesArr[index];
        
        // Обновляем анимации по ID слайда, чтобы не зависеть от порядка
        // chartScatter удален из списка обновлений
        if (currentSlideEl.id === 'chartSlideDist') {
            if (chartPyatDist) chartPyatDist.updateOptions({ chart: { animations: { enabled: true } } });
            if (chartShopsDist) chartShopsDist.updateOptions({ chart: { animations: { enabled: true } } });
        }
        if (currentSlideEl.id === 'chartSlide1') {
            if (chartSettlements) chartSettlements.updateOptions({ chart: { animations: { enabled: true } } });
            if (chartAvgCheck) chartAvgCheck.updateOptions({ chart: { animations: { enabled: true } } });
        }
        if (currentSlideEl.id === 'chartSlideAge') {
            if (chartAgeRevenue) chartAgeRevenue.updateOptions({ chart: { animations: { enabled: true } } });
        }
        if (currentSlideEl.id === 'chartSlideAge' && chartAgeRevenue) {
        chartAgeRevenue.updateOptions({ chart: { animations: { enabled: true } } });
    }
        if (currentSlideEl.id === 'chartSlide2' && chartHeatmap) {
            chartHeatmap.updateOptions({ chart: { animations: { enabled: true } } });
        }
        if (currentSlideEl.id === 'chartSlide3') {
            if (chartTtest) chartTtest.updateOptions({ chart: { animations: { enabled: true } } });
            if (chartTtest2) chartTtest2.updateOptions({ chart: { animations: { enabled: true } } });
        }
        if (currentSlideEl.id === 'chartSlide4' && chartRobustness) {
            chartRobustness.updateOptions({ chart: { animations: { enabled: true } } });
        }
        // Для мини графика на слайде с метриками
        if (currentSlideEl.id === 'slide-metrics' && chartMiniRevenue) {
            chartMiniRevenue.updateOptions({ chart: { animations: { enabled: true } } });
        }
    }

    function nextSlide() {
        currentSlide = (currentSlide + 1) % slides.length;
        showSlide(currentSlide);
    }

    function prevSlide() {
        currentSlide = (currentSlide - 1 + slides.length) % slides.length;
        showSlide(currentSlide);
    }

    document.addEventListener('keydown', (e) => {
        if (e.key === 'ArrowRight' || e.key === 'Space') nextSlide();
        if (e.key === 'ArrowLeft') prevSlide();
    });

    const teamPhotos = document.querySelectorAll('.team-photo-box');
    const explosionOverlay = document.getElementById('resurrection-explosion');
    if (teamPhotos.length > 0 && explosionOverlay) {
        teamPhotos.forEach(photo => {
            photo.addEventListener('mouseenter', () => {
                if (photo.id === 'offlane-photo') return;
                if (!photo.classList.contains('dead') && !photo.classList.contains('resurrected')) {
                    photo.classList.add('dead');
                } else if (photo.classList.contains('dead')) {
                    triggerResurrection(photo);
                }
            });
        });
    }

    function triggerResurrection(element) {
        explosionOverlay.classList.add('explode-anim');
        setTimeout(() => {
            element.classList.remove('dead');
            element.classList.add('resurrected');
        }, 400);
        setTimeout(() => {
            explosionOverlay.classList.remove('explode-anim');
        }, 800);
    }
</script>
</body>
</html>